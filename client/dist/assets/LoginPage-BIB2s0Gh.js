import{u as w,a as f,b,c as A,r as o,d,e as T,j as e}from"./index-DXbm8Z41.js";function S(){const[r]=w(),a=f(),n=b(),{isAuthenticated:g,loading:x}=A(s=>s.auth),[h,c]=o.useState(null),[j,u]=o.useState(!1);return o.useEffect(()=>{if(g){a("/",{replace:!0});return}const s=r.get("token")||r.get("session");if(r.get("userId"),s){console.log("üì• –û–±–Ω–∞—Ä—É–∂–µ–Ω —Ç–æ–∫–µ–Ω –≤ URL, –∞–≤—Ç–æ—Ä–∏–∑—É–µ–º—Å—è..."),localStorage.setItem("authToken",s),n(d()).unwrap().then(()=>{console.log("‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ URL —É—Å–ø–µ—à–Ω–∞"),a("/",{replace:!0})}).catch(i=>{console.error("‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ URL:",i),c("–ù–µ —É–¥–∞–ª–æ—Å—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram."),localStorage.removeItem("authToken")});return}localStorage.getItem("authToken")&&n(d())},[g,a,n,r]),o.useEffect(()=>{window.onTelegramAuth=async i=>{var m,p;console.log("üì• –ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ—Ç Telegram:",i),u(!0),c(null);try{const l=await T.post("/auth/telegram-widget",i),{token:N,user:v}=l.data;localStorage.setItem("authToken",N),console.log("‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞:",v.displayName),await n(d()).unwrap(),a("/",{replace:!0})}catch(l){console.error("‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:",l),c(((p=(m=l.response)==null?void 0:m.data)==null?void 0:p.error)||"–ù–µ —É–¥–∞–ª–æ—Å—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è"),u(!1)}};const s=document.createElement("script");s.src="https://telegram.org/js/telegram-widget.js?22",s.setAttribute("data-telegram-login","watchRebel_bot"),s.setAttribute("data-size","large"),s.setAttribute("data-radius","8"),s.setAttribute("data-onauth","onTelegramAuth(user)"),s.setAttribute("data-request-access","write"),s.async=!0;const t=document.getElementById("telegram-login-container");return t&&t.appendChild(s),()=>{t&&s.parentNode===t&&t.removeChild(s),delete window.onTelegramAuth}},[n,a]),x||j?e.jsx("div",{className:"login-page",children:e.jsx("div",{className:"login-container",children:e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-logo",children:[e.jsx("h1",{children:"watchRebel"}),e.jsx("p",{className:"login-subtitle",children:"–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –∫–∏–Ω–æ –∏ —Å–µ—Ä–∏–∞–ª–æ–≤"})]}),e.jsxs("div",{className:"login-loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è..."})]})]})})}):e.jsx("div",{className:"login-page",children:e.jsx("div",{className:"login-container",children:e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-logo",children:[e.jsx("h1",{children:"watchRebel"}),e.jsx("p",{className:"login-subtitle",children:"–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –∫–∏–Ω–æ –∏ —Å–µ—Ä–∏–∞–ª–æ–≤"})]}),e.jsxs("div",{className:"login-content",children:[e.jsx("div",{className:"login-icon",children:e.jsx("img",{src:"/images/logo-animation.png",alt:"watchRebel"})}),e.jsx("h2",{children:"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!"}),e.jsx("p",{className:"login-description",children:"–í–µ–¥–∏—Ç–µ —É—á–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤ –∏ —Å–µ—Ä–∏–∞–ª–æ–≤, –¥–µ–ª–∏—Ç–µ—Å—å –æ—Ç–∑—ã–≤–∞–º–∏ –∏ –Ω–∞—Ö–æ–¥–∏—Ç–µ –¥—Ä—É–∑–µ–π —Å –ø–æ—Ö–æ–∂–∏–º–∏ –≤–∫—É—Å–∞–º–∏"}),e.jsxs("div",{className:"login-telegram-widget",children:[e.jsx("p",{className:"widget-label",children:"–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram:"}),e.jsx("div",{id:"telegram-login-container"})]}),h&&e.jsxs("div",{className:"login-error-message",children:[e.jsx("span",{className:"error-icon",children:"‚ö†Ô∏è"}),e.jsx("p",{children:h})]})]})]})})})}export{S as default};
//# sourceMappingURL=LoginPage-BIB2s0Gh.js.map
