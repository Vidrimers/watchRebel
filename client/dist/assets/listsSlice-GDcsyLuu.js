import{d as i,e as o,A as l,N as c,f as n}from"./index-Djl9NHxl.js";const d=(e,t)=>e instanceof l?t(e.data||e.message):e instanceof c?t({message:e.message}):t({message:"Неизвестная ошибка"}),p=i("lists/fetchLists",async(e,{rejectWithValue:t})=>{try{return(await o.get("/lists")).data}catch(s){return d(s,t)}}),u=i("lists/createList",async({name:e,mediaType:t},{rejectWithValue:s})=>{try{return(await o.post("/lists",{name:e,mediaType:t})).data}catch(a){return d(a,s)}}),f=i("lists/deleteList",async(e,{rejectWithValue:t})=>{try{return await o.delete(`/lists/${e}`),e}catch(s){return d(s,t)}}),y=i("lists/addToList",async({listId:e,media:t},{rejectWithValue:s})=>{try{const a=await o.post(`/lists/${e}/items`,t);return{listId:e,item:a.data}}catch(a){return d(a,s)}}),h=i("lists/fetchWatchlist",async(e,{rejectWithValue:t})=>{try{return(await o.get("/watchlist")).data}catch(s){return d(s,t)}}),m=i("lists/addToWatchlist",async(e,{rejectWithValue:t})=>{try{return(await o.post("/watchlist",e)).data}catch(s){return d(s,t)}}),g=i("lists/removeFromWatchlist",async(e,{rejectWithValue:t})=>{try{return await o.delete(`/watchlist/${e}`),e}catch(s){return d(s,t)}}),w=i("lists/removeFromList",async({listId:e,itemId:t},{rejectWithValue:s})=>{try{return await o.delete(`/lists/${e}/items/${t}`),{listId:e,itemId:t}}catch(a){return d(a,s)}}),L=i("lists/fetchEpisodeProgress",async(e,{rejectWithValue:t})=>{try{const s=await o.get(`/progress/${e}`);return{seriesId:e,progress:s.data}}catch(s){return d(s,t)}}),C=i("lists/markEpisodeWatched",async({tmdbId:e,seasonNumber:t,episodeNumber:s},{rejectWithValue:a})=>{try{return(await o.post("/progress",{tmdbId:e,seasonNumber:t,episodeNumber:s})).data}catch(r){return d(r,a)}}),P=i("lists/addRating",async({tmdbId:e,mediaType:t,rating:s},{rejectWithValue:a})=>{try{return(await o.post("/ratings",{tmdbId:e,mediaType:t,rating:s})).data}catch(r){return d(r,a)}});n({name:"lists",initialState:{customLists:[],watchlist:[],episodeProgress:{},ratings:{},loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(p.fulfilled,(t,s)=>{t.customLists=s.payload}).addCase(u.fulfilled,(t,s)=>{t.customLists.push(s.payload)}).addCase(f.fulfilled,(t,s)=>{t.customLists=t.customLists.filter(a=>a.id!==s.payload)}).addCase(y.fulfilled,(t,s)=>{const a=t.customLists.find(r=>r.id===s.payload.listId);a&&a.items.push(s.payload.item)}).addCase(h.fulfilled,(t,s)=>{t.watchlist=s.payload}).addCase(m.fulfilled,(t,s)=>{t.watchlist.push(s.payload)}).addCase(g.fulfilled,(t,s)=>{t.watchlist=t.watchlist.filter(a=>a.id!==s.payload)}).addCase(w.fulfilled,(t,s)=>{const a=t.customLists.find(r=>r.id===s.payload.listId);a&&(a.items=a.items.filter(r=>r.id!==s.payload.itemId))}).addCase(L.fulfilled,(t,s)=>{t.episodeProgress[s.payload.seriesId]=s.payload.progress}).addCase(C.fulfilled,(t,s)=>{const a=s.payload.tmdbId;t.episodeProgress[a]||(t.episodeProgress[a]=[]),t.episodeProgress[a].push(s.payload)}).addCase(P.fulfilled,(t,s)=>{t.ratings[s.payload.tmdbId]=s.payload.rating})}});export{P as a,L as b,m as c,y as d,u as e,p as f,f as g,h,C as m};
//# sourceMappingURL=listsSlice-GDcsyLuu.js.map
