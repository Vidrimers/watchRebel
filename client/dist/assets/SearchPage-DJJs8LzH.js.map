{"version":3,"file":"SearchPage-DJJs8LzH.js","sources":["../../src/pages/SearchPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useSearchParams, useNavigate } from 'react-router-dom';\r\nimport { useAppDispatch } from '../hooks/useAppDispatch';\r\nimport { useAppSelector } from '../hooks/useAppSelector';\r\nimport { searchMedia } from '../store/slices/mediaSlice';\r\nimport UserPageLayout from '../components/Layout/UserPageLayout';\r\nimport styles from './SearchPage.module.css';\r\n\r\n/**\r\n * –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∏—Å–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏\r\n * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–æ–ª–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏\r\n */\r\nconst SearchPage = () => {\r\n  const dispatch = useAppDispatch();\r\n  const navigate = useNavigate();\r\n  const [searchParams] = useSearchParams();\r\n  \r\n  const { searchResults, loading, error } = useAppSelector((state) => state.media);\r\n  const { user } = useAppSelector((state) => state.auth);\r\n  \r\n  const query = searchParams.get('q') || '';\r\n  const [activeFilter, setActiveFilter] = useState('all'); // all, users, movies, tv\r\n\r\n  // –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ query\r\n  useEffect(() => {\r\n    if (query.trim()) {\r\n      dispatch(searchMedia({ query, filters: {} }));\r\n    }\r\n  }, [query, dispatch]);\r\n\r\n  // –§–∏–ª—å—Ç—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∞–∫—Ç–∏–≤–Ω–æ–º—É —Ñ–∏–ª—å—Ç—Ä—É\r\n  const filteredResults = searchResults.filter((result) => {\r\n    if (activeFilter === 'all') return true;\r\n    if (activeFilter === 'users') return result.type === 'user';\r\n    if (activeFilter === 'movies') return result.type === 'movie';\r\n    if (activeFilter === 'tv') return result.type === 'tv';\r\n    return true;\r\n  });\r\n\r\n  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç\r\n  const handleResultClick = (result) => {\r\n    if (result.type === 'user') {\r\n      navigate(`/user/${result.data.id}`);\r\n    } else {\r\n      navigate(`/media/${result.data.mediaType}/${result.data.tmdbId}`);\r\n    }\r\n  };\r\n\r\n  // –ü–æ–¥—Å—á–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ —Ç–∏–ø–∞–º\r\n  const counts = {\r\n    all: searchResults.length,\r\n    users: searchResults.filter((r) => r.type === 'user').length,\r\n    movies: searchResults.filter((r) => r.type === 'movie').length,\r\n    tv: searchResults.filter((r) => r.type === 'tv').length\r\n  };\r\n\r\n  return (\r\n    <UserPageLayout user={user}>\r\n      <div className={styles.searchPage}>\r\n        {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}\r\n        <div className={styles.header}>\r\n          <h1 className={styles.title}>\r\n            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: <span className={styles.query}>\"{query}\"</span>\r\n          </h1>\r\n          <p className={styles.subtitle}>\r\n            –ù–∞–π–¥–µ–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: {filteredResults.length}\r\n          </p>\r\n        </div>\r\n\r\n        {/* –§–∏–ª—å—Ç—Ä—ã */}\r\n        <div className={styles.filters}>\r\n          <button\r\n            className={`${styles.filterButton} ${activeFilter === 'all' ? styles.active : ''}`}\r\n            onClick={() => setActiveFilter('all')}\r\n          >\r\n            –í—Å–µ ({counts.all})\r\n          </button>\r\n          <button\r\n            className={`${styles.filterButton} ${activeFilter === 'users' ? styles.active : ''}`}\r\n            onClick={() => setActiveFilter('users')}\r\n          >\r\n            –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ({counts.users})\r\n          </button>\r\n          <button\r\n            className={`${styles.filterButton} ${activeFilter === 'movies' ? styles.active : ''}`}\r\n            onClick={() => setActiveFilter('movies')}\r\n          >\r\n            –§–∏–ª—å–º—ã ({counts.movies})\r\n          </button>\r\n          <button\r\n            className={`${styles.filterButton} ${activeFilter === 'tv' ? styles.active : ''}`}\r\n            onClick={() => setActiveFilter('tv')}\r\n          >\r\n            –°–µ—Ä–∏–∞–ª—ã ({counts.tv})\r\n          </button>\r\n        </div>\r\n\r\n        {/* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */}\r\n        <div className={styles.results}>\r\n          {loading ? (\r\n            <div className={styles.loading}>\r\n              <div className={styles.spinner}></div>\r\n              <p>–ü–æ–∏—Å–∫...</p>\r\n            </div>\r\n          ) : error ? (\r\n            <div className={styles.error}>\r\n              <p>–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ</p>\r\n              <p className={styles.errorMessage}>{error.message || '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑'}</p>\r\n            </div>\r\n          ) : filteredResults.length > 0 ? (\r\n            <div className={styles.resultsList}>\r\n              {filteredResults.map((result, index) => (\r\n                <div\r\n                  key={`${result.type}-${result.data.id || result.data.tmdbId}-${index}`}\r\n                  className={styles.resultCard}\r\n                  onClick={() => handleResultClick(result)}\r\n                >\r\n                  {result.type === 'user' ? (\r\n                    // –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\r\n                    <div className={styles.userCard}>\r\n                      <img\r\n                        src={result.data.avatarUrl || '/default-avatar.png'}\r\n                        alt={result.data.displayName}\r\n                        className={styles.userAvatar}\r\n                      />\r\n                      <div className={styles.userCardInfo}>\r\n                        <h3 className={styles.userCardName}>{result.data.displayName}</h3>\r\n                        <p className={styles.userCardType}>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</p>\r\n                        {result.data.telegramUsername && (\r\n                          <p className={styles.userCardUsername}>@{result.data.telegramUsername}</p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    // –ö–∞—Ä—Ç–æ—á–∫–∞ –º–µ–¥–∏–∞\r\n                    <div className={styles.mediaCard}>\r\n                      <img\r\n                        src={\r\n                          result.data.posterPath\r\n                            ? `https://image.tmdb.org/t/p/w185${result.data.posterPath}`\r\n                            : '/default-poster.png'\r\n                        }\r\n                        alt={result.data.title}\r\n                        className={styles.mediaPoster}\r\n                      />\r\n                      <div className={styles.mediaCardInfo}>\r\n                        <h3 className={styles.mediaCardTitle}>{result.data.title}</h3>\r\n                        <p className={styles.mediaCardType}>\r\n                          {result.data.mediaType === 'movie' ? 'üé¨ –§–∏–ª—å–º' : 'üì∫ –°–µ—Ä–∏–∞–ª'}\r\n                        </p>\r\n                        {result.data.releaseDate && (\r\n                          <p className={styles.mediaCardYear}>\r\n                            {new Date(result.data.releaseDate).getFullYear()}\r\n                          </p>\r\n                        )}\r\n                        {result.data.overview && (\r\n                          <p className={styles.mediaCardOverview}>\r\n                            {result.data.overview.length > 150\r\n                              ? `${result.data.overview.substring(0, 150)}...`\r\n                              : result.data.overview}\r\n                          </p>\r\n                        )}\r\n                        {result.data.voteAverage > 0 && (\r\n                          <div className={styles.mediaCardRating}>\r\n                            ‚≠ê {result.data.voteAverage.toFixed(1)}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className={styles.empty}>\r\n              <p>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>\r\n              <p className={styles.emptyHint}>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </UserPageLayout>\r\n  );\r\n};\r\n\r\nexport default SearchPage;\r\n"],"names":["SearchPage","dispatch","useAppDispatch","navigate","useNavigate","searchParams","useSearchParams","searchResults","loading","error","useAppSelector","state","user","query","activeFilter","setActiveFilter","useState","useEffect","searchMedia","filteredResults","result","handleResultClick","counts","r","UserPageLayout","styles","jsxs","jsx","index"],"mappings":"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"}