import{j as e,b as k,a as T,c as b,r as m,s as U,F as C,G as P,A as E}from"./index-C3TbUOD_.js";const A="_avatarContainer_qjq6q_1",D="_avatarImage_qjq6q_21",S="_avatarPlaceholder_qjq6q_33",j={avatarContainer:A,avatarImage:D,avatarPlaceholder:S,"avatar-small":"_avatar-small_qjq6q_57","avatar-medium":"_avatar-medium_qjq6q_69","avatar-large":"_avatar-large_qjq6q_81","avatar-xlarge":"_avatar-xlarge_qjq6q_93"},W="_banIndicator_1l2eb_1",F="_badge_1l2eb_33",M="_permanentBan_1l2eb_57",Q="_postBan_1l2eb_67",z="_details_1l2eb_77",K="_reason_1l2eb_99",Y="_expires_1l2eb_121",p={banIndicator:W,badge:F,permanentBan:M,postBan:Q,details:z,reason:K,expires:Y};function G({user:a}){if(!a)return null;const s=a.isBlocked,i=a.postBanUntil&&new Date(a.postBanUntil)>new Date;if(!s&&!i)return null;const _=h=>{const o=new Date(h),c=o-new Date;return c<60*60*1e3?`Ñ‡ÐµÑ€ÐµÐ· ${Math.floor(c/6e4)} Ð¼Ð¸Ð½`:c<24*60*60*1e3?`Ñ‡ÐµÑ€ÐµÐ· ${Math.floor(c/36e5)} Ñ‡`:c<7*24*60*60*1e3?`Ñ‡ÐµÑ€ÐµÐ· ${Math.floor(c/864e5)} Ð´Ð½`:o.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})};return e.jsxs("div",{className:p.banIndicator,children:[e.jsx("div",{className:`${p.badge} ${s?p.permanentBan:p.postBan}`,children:s?"â›” Ð—ÐÐ‘ÐÐÐ•Ð":"ðŸš« ÐŸÐžÐ¡Ð¢Ð« Ð—ÐÐŸÐ Ð•Ð©Ð•ÐÐ«"}),a.banReason&&e.jsxs("div",{className:p.details,children:[e.jsxs("div",{className:p.reason,children:[e.jsx("strong",{children:"ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°:"})," ",a.banReason]}),i&&!s&&a.postBanUntil&&e.jsxs("div",{className:p.expires,children:[e.jsx("strong",{children:"Ð”Ð¾:"})," ",_(a.postBanUntil)]})]})]})}const O=({user:a,size:s="medium",className:i="",showBanIndicator:_=!1})=>{var c;const h=j[`avatar-${s}`],v=a!=null&&a.avatarUrl?a.avatarUrl.startsWith("/uploads/")?`http://localhost:1313${a.avatarUrl}`:a.avatarUrl:null;return e.jsxs("div",{className:`${j.avatarContainer} ${h} ${i}`,children:[v?e.jsx("img",{src:v,alt:a.displayName||"ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ",className:j.avatarImage}):e.jsx("div",{className:j.avatarPlaceholder,children:((c=a==null?void 0:a.displayName)==null?void 0:c.charAt(0).toUpperCase())||"?"}),_&&e.jsx(G,{user:a})]})},H="_errorInline_118it_211",J="_errorInlineIcon_118it_235",V="_errorInlineText_118it_243",X="_errorInlineClose_118it_251",x={errorInline:H,errorInlineIcon:J,errorInlineText:V,errorInlineClose:X},Z=({error:a,onClose:s})=>{if(!a)return null;const i=typeof a=="string"?a:a.message||a.error||"ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ°";return e.jsxs("div",{className:x.errorInline,role:"alert",children:[e.jsx("span",{className:x.errorInlineIcon,children:"âš ï¸"}),e.jsx("span",{className:x.errorInlineText,children:i}),s&&e.jsx("button",{onClick:s,className:x.errorInlineClose,"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",children:"Ã—"})]})},ee="_searchContainer_1h2ou_3",ae="_searchInputWrapper_1h2ou_17",se="_searchInput_1h2ou_17",te="_searchButton_1h2ou_57",ne="_searchPreview_1h2ou_131",re="_previewLoading_1h2ou_161",ie="_previewEmpty_1h2ou_175",oe="_previewList_1h2ou_189",ce="_previewItem_1h2ou_203",le="_userResult_1h2ou_235",de="_userAvatar_1h2ou_247",me="_userInfo_1h2ou_261",_e="_userName_1h2ou_273",he="_userType_1h2ou_285",pe="_mediaResult_1h2ou_297",ue="_mediaPoster_1h2ou_309",ve="_mediaInfo_1h2ou_323",fe="_mediaTitle_1h2ou_335",je="_mediaType_1h2ou_347",xe="_previewFooter_1h2ou_359",n={searchContainer:ee,searchInputWrapper:ae,searchInput:se,searchButton:te,searchPreview:ne,previewLoading:re,previewEmpty:ie,previewList:oe,previewItem:ce,userResult:le,userAvatar:de,userInfo:me,userName:_e,userType:he,mediaResult:pe,mediaPoster:ue,mediaInfo:ve,mediaTitle:fe,mediaType:je,previewFooter:xe},Ne=()=>{const a=k(),s=T(),{searchResults:i,loading:_,error:h}=b(t=>t.media),[o,v]=m.useState(""),[c,l]=m.useState(!1),[N,$]=m.useState(""),g=m.useRef(null),f=m.useRef(null);m.useEffect(()=>(f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{$(o)},300),()=>{f.current&&clearTimeout(f.current)}),[o]),m.useEffect(()=>{N.trim().length>0?(a(U({query:N,filters:{}})),l(!0)):l(!1)},[N,a]),m.useEffect(()=>{const t=u=>{g.current&&!g.current.contains(u.target)&&l(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]);const L=t=>{const u=t.target.value;v(u),a(P(u)),h&&a(C())},q=t=>{t.key==="Enter"&&o.trim()&&(l(!1),s(`/search?q=${encodeURIComponent(o)}`))},B=t=>{l(!1),t.type==="user"?s(`/user/${t.data.id}`):s(`/media/${t.data.mediaType}/${t.data.tmdbId}`)},y=Array.isArray(i)?i.slice(0,5):[],R=()=>{l(!1),o.trim()?s(`/search?q=${encodeURIComponent(o)}`):s("/search")};return e.jsxs("div",{className:n.searchContainer,ref:g,children:[e.jsxs("div",{className:n.searchInputWrapper,children:[e.jsx("input",{type:"text",placeholder:"ÐŸÐ¾Ð¸ÑÐº Ñ„Ð¸Ð»ÑŒÐ¼Ð¾Ð², ÑÐµÑ€Ð¸Ð°Ð»Ð¾Ð², Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹...",className:n.searchInput,value:o,onChange:L,onKeyDown:q,onFocus:()=>o.trim()&&l(!0)}),e.jsx("button",{className:n.searchButton,onClick:R,title:"ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº","aria-label":"ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº",children:"ðŸ”"})]}),c&&o.trim()&&e.jsxs("div",{className:n.searchPreview,children:[h&&e.jsx("div",{className:n.previewError,children:e.jsx(Z,{error:h,onClose:()=>a(C())})}),_?e.jsx("div",{className:n.previewLoading,children:e.jsx("span",{children:"ÐŸÐ¾Ð¸ÑÐº..."})}):y.length>0?e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:n.previewList,children:y.map((t,u)=>{var w;return e.jsx("li",{className:n.previewItem,onClick:()=>B(t),children:t.type==="user"?e.jsxs("div",{className:n.userResult,children:[e.jsx("img",{src:(w=t.data.avatarUrl)!=null&&w.startsWith("/uploads/")?`http://localhost:1313${t.data.avatarUrl}`:t.data.avatarUrl||"/default-avatar.png",alt:t.data.displayName,className:n.userAvatar}),e.jsxs("div",{className:n.userInfo,children:[e.jsx("span",{className:n.userName,children:t.data.displayName}),e.jsx("span",{className:n.userType,children:"ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ"})]})]}):e.jsxs("div",{className:n.mediaResult,children:[e.jsx("img",{src:t.data.posterPath?`https://image.tmdb.org/t/p/w92${t.data.posterPath}`:"/default-poster.png",alt:t.data.title,className:n.mediaPoster}),e.jsxs("div",{className:n.mediaInfo,children:[e.jsx("span",{className:n.mediaTitle,children:t.data.title}),e.jsx("span",{className:n.mediaType,children:t.data.mediaType==="movie"?"Ð¤Ð¸Ð»ÑŒÐ¼":"Ð¡ÐµÑ€Ð¸Ð°Ð»"})]})]})},`${t.type}-${t.data.id||t.data.tmdbId}-${u}`)})}),i.length>5&&e.jsxs("div",{className:n.previewFooter,onClick:()=>{l(!1),s(`/search?q=${encodeURIComponent(o)}`)},children:["ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð²ÑÐµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ (",i.length,")"]})]}):e.jsx("div",{className:n.previewEmpty,children:e.jsx("span",{children:"ÐÐ¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾"})})]})]})},ge="_badge_1nn9d_1",Ie={badge:ge},ye=()=>{const a=k(),{unreadCount:s,loading:i}=b(_=>_.notifications);return m.useEffect(()=>{a(E())},[a]),s===0?null:e.jsx("span",{className:Ie.badge,"aria-label":`${s} Ð½ÐµÐ¿Ñ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð½Ð½Ñ‹Ñ… ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹`,children:s>99?"99+":s})},we="_sidebar_t7jfw_3",Ce="_narrow_t7jfw_31",ke="_userInfo_t7jfw_41",be="_navLink_t7jfw_49",$e="_notificationsLink_t7jfw_51",Le="_settingsLink_t7jfw_53",qe="_userName_t7jfw_101",Be="_navigation_t7jfw_119",Re="_navList_t7jfw_133",Te="_navItem_t7jfw_151",Ue="_notificationsContainer_t7jfw_191",Pe="_settingsContainer_t7jfw_261",r={sidebar:we,narrow:Ce,userInfo:ke,navLink:be,notificationsLink:$e,settingsLink:Le,userName:qe,navigation:Be,navList:Re,navItem:Te,notificationsContainer:Ue,settingsContainer:Pe},Ee=({user:a,narrow:s=!1})=>e.jsxs("aside",{className:`${r.sidebar} ${s?r.narrow:""}`,children:[!s&&e.jsx(Ne,{}),a&&e.jsxs("div",{className:r.userInfo,children:[e.jsx(O,{user:a,size:s?"small":"medium"}),!s&&e.jsx("h2",{className:r.userName,children:a.displayName})]}),e.jsx("nav",{className:r.navigation,children:e.jsxs("ul",{className:r.navList,children:[e.jsx("li",{className:r.navItem,children:e.jsxs("a",{href:"/",className:r.navLink,title:"Ð“Ð»Ð°Ð²Ð½Ð°Ñ",children:["ðŸ  ",!s&&"Ð“Ð»Ð°Ð²Ð½Ð°Ñ"]})}),e.jsx("li",{className:r.navItem,children:e.jsxs("a",{href:"/lists?type=movie",className:r.navLink,title:"ÐœÐ¾Ð¸ Ñ„Ð¸Ð»ÑŒÐ¼Ñ‹",children:["ðŸŽ¬ ",!s&&"ÐœÐ¾Ð¸ Ñ„Ð¸Ð»ÑŒÐ¼Ñ‹"]})}),e.jsx("li",{className:r.navItem,children:e.jsxs("a",{href:"/lists?type=tv",className:r.navLink,title:"ÐœÐ¾Ð¸ ÑÐµÑ€Ð¸Ð°Ð»Ñ‹",children:["ðŸ“º ",!s&&"ÐœÐ¾Ð¸ ÑÐµÑ€Ð¸Ð°Ð»Ñ‹"]})}),e.jsx("li",{className:r.navItem,children:e.jsxs("a",{href:"/watchlist",className:r.navLink,title:"Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¶ÐµÐ»Ð°ÐµÐ¼Ð¾Ð³Ð¾",children:["â­ ",!s&&"Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¶ÐµÐ»Ð°ÐµÐ¼Ð¾Ð³Ð¾"]})}),e.jsx("li",{className:r.navItem,children:e.jsxs("a",{href:"/friends",className:r.navLink,title:"Ð”Ñ€ÑƒÐ·ÑŒÑ",children:["ðŸ‘¥ ",!s&&"Ð”Ñ€ÑƒÐ·ÑŒÑ"]})})]})}),e.jsx("div",{className:r.notificationsContainer,children:e.jsxs("a",{href:"/notifications",className:r.notificationsLink,title:"Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ",children:["ðŸ”” ",!s&&"Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ",e.jsx(ye,{})]})}),e.jsx("div",{className:r.settingsContainer,children:e.jsxs("a",{href:"/settings",className:r.settingsLink,title:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸",children:["âš™ï¸ ",!s&&"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸"]})})]}),Ae="_footer_195rk_3",De="_footerContent_195rk_17",Se="_copyright_195rk_35",We="_links_195rk_49",Fe="_link_195rk_49",Me="_separator_195rk_87",d={footer:Ae,footerContent:De,copyright:Se,links:We,link:Fe,separator:Me},Qe=()=>{const a=new Date().getFullYear();return e.jsx("footer",{className:d.footer,children:e.jsxs("div",{className:d.footerContent,children:[e.jsxs("p",{className:d.copyright,children:["Â© ",a," watchRebel. Ð¡Ð¾Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ ÑÐµÑ‚ÑŒ Ð´Ð»Ñ Ð»ÑŽÐ±Ð¸Ñ‚ÐµÐ»ÐµÐ¹ ÐºÐ¸Ð½Ð¾."]}),e.jsxs("div",{className:d.links,children:[e.jsx("a",{href:"/about",className:d.link,children:"Ðž Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ"}),e.jsx("span",{className:d.separator,children:"â€¢"}),e.jsx("a",{href:"/privacy",className:d.link,children:"ÐšÐ¾Ð½Ñ„Ð¸Ð´ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ"}),e.jsx("span",{className:d.separator,children:"â€¢"}),e.jsx("a",{href:"/terms",className:d.link,children:"Ð£ÑÐ»Ð¾Ð²Ð¸Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ"})]})]})})},ze="_pageContainer_pdvjh_3",Ke="_contentWrapper_pdvjh_19",Ye="_mainContent_pdvjh_41",I={pageContainer:ze,contentWrapper:Ke,mainContent:Ye},Oe=({children:a,user:s,narrowSidebar:i=!1})=>e.jsxs("div",{className:I.pageContainer,children:[e.jsxs("div",{className:I.contentWrapper,children:[e.jsx("main",{className:I.mainContent,children:a}),e.jsx(Ee,{user:s,narrow:i})]}),e.jsx(Qe,{})]});export{Oe as U,O as a};
//# sourceMappingURL=UserPageLayout-D6-bMz6K.js.map
