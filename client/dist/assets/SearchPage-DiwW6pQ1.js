import{b as N,a as j,u as f,c as v,r as h,s as y,j as a}from"./index-BDVNw2dN.js";import{U as $}from"./UserPageLayout--cGvvqMr.js";const b="_searchPage_1u8l0_3",P="_header_1u8l0_19",T="_title_1u8l0_27",w="_query_1u8l0_41",U="_subtitle_1u8l0_49",I="_filters_1u8l0_61",A="_filterButton_1u8l0_75",R="_active_1u8l0_109",B="_results_1u8l0_123",k="_loading_1u8l0_133",q="_spinner_1u8l0_151",L="_error_1u8l0_185",M="_errorMessage_1u8l0_197",S="_empty_1u8l0_211",Y="_emptyHint_1u8l0_223",D="_resultsList_1u8l0_235",F="_resultCard_1u8l0_249",H="_userCard_1u8l0_281",O="_userAvatar_1u8l0_293",E="_userCardInfo_1u8l0_309",W="_userCardName_1u8l0_317",z="_userCardType_1u8l0_331",G="_userCardUsername_1u8l0_343",J="_mediaCard_1u8l0_355",K="_mediaPoster_1u8l0_365",Q="_mediaCardInfo_1u8l0_381",V="_mediaCardTitle_1u8l0_393",X="_mediaCardType_1u8l0_409",Z="_mediaCardYear_1u8l0_421",ee="_mediaCardOverview_1u8l0_433",ae="_mediaCardRating_1u8l0_449",s={searchPage:b,header:P,title:T,query:w,subtitle:U,filters:I,filterButton:A,active:R,results:B,loading:k,spinner:q,error:L,errorMessage:M,empty:S,emptyHint:Y,resultsList:D,resultCard:F,userCard:H,userAvatar:O,userCardInfo:E,userCardName:W,userCardType:z,userCardUsername:G,mediaCard:J,mediaPoster:K,mediaCardInfo:Q,mediaCardTitle:V,mediaCardType:X,mediaCardYear:Z,mediaCardOverview:ee,mediaCardRating:ae},te=()=>{const o=N(),m=j(),[p]=f(),{searchResults:t,loading:C,error:u}=v(e=>e.media),{user:i}=v(e=>e.auth),d=p.get("q")||"",[r,l]=h.useState("all");h.useEffect(()=>{d.trim()&&o(y({query:d,filters:{}}))},[d,o]);const c=t.filter(e=>r==="all"?!0:r==="users"?e.type==="user":r==="movies"?e.type==="movie":r==="tv"?e.type==="tv":!0),g=e=>{e.type==="user"?m(`/user/${e.data.id}`):m(`/media/${e.data.mediaType}/${e.data.tmdbId}`)},n={all:t.length,users:t.filter(e=>e.type==="user").length,movies:t.filter(e=>e.type==="movie").length,tv:t.filter(e=>e.type==="tv").length};return a.jsx($,{user:i,narrowSidebar:!0,children:a.jsxs("div",{className:s.searchPage,children:[a.jsxs("div",{className:s.header,children:[a.jsxs("h1",{className:s.title,children:["–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: ",a.jsxs("span",{className:s.query,children:['"',d,'"']})]}),a.jsxs("p",{className:s.subtitle,children:["–ù–∞–π–¥–µ–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: ",c.length]})]}),a.jsxs("div",{className:s.filters,children:[a.jsxs("button",{className:`${s.filterButton} ${r==="all"?s.active:""}`,onClick:()=>l("all"),children:["–í—Å–µ (",n.all,")"]}),a.jsxs("button",{className:`${s.filterButton} ${r==="users"?s.active:""}`,onClick:()=>l("users"),children:["–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (",n.users,")"]}),a.jsxs("button",{className:`${s.filterButton} ${r==="movies"?s.active:""}`,onClick:()=>l("movies"),children:["–§–∏–ª—å–º—ã (",n.movies,")"]}),a.jsxs("button",{className:`${s.filterButton} ${r==="tv"?s.active:""}`,onClick:()=>l("tv"),children:["–°–µ—Ä–∏–∞–ª—ã (",n.tv,")"]})]}),a.jsx("div",{className:s.results,children:C?a.jsxs("div",{className:s.loading,children:[a.jsx("div",{className:s.spinner}),a.jsx("p",{children:"–ü–æ–∏—Å–∫..."})]}):u?a.jsxs("div",{className:s.error,children:[a.jsx("p",{children:"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ"}),a.jsx("p",{className:s.errorMessage,children:u.message||"–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑"})]}):c.length>0?a.jsx("div",{className:s.resultsList,children:c.map((e,x)=>{var _;return a.jsx("div",{className:s.resultCard,onClick:()=>g(e),children:e.type==="user"?a.jsxs("div",{className:s.userCard,children:[a.jsx("img",{src:(_=e.data.avatarUrl)!=null&&_.startsWith("/uploads/")?`http://localhost:1313${e.data.avatarUrl}`:e.data.avatarUrl||"/default-avatar.png",alt:e.data.displayName,className:s.userAvatar}),a.jsxs("div",{className:s.userCardInfo,children:[a.jsx("h3",{className:s.userCardName,children:e.data.displayName}),a.jsx("p",{className:s.userCardType,children:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"}),(i==null?void 0:i.id)===e.data.id&&e.data.telegramUsername&&a.jsxs("p",{className:s.userCardUsername,children:["@",e.data.telegramUsername]})]})]}):a.jsxs("div",{className:s.mediaCard,children:[a.jsx("img",{src:e.data.posterPath?`https://image.tmdb.org/t/p/w185${e.data.posterPath}`:"/default-poster.png",alt:e.data.title,className:s.mediaPoster}),a.jsxs("div",{className:s.mediaCardInfo,children:[a.jsx("h3",{className:s.mediaCardTitle,children:e.data.title}),a.jsx("p",{className:s.mediaCardType,children:e.data.mediaType==="movie"?"üé¨ –§–∏–ª—å–º":"üì∫ –°–µ—Ä–∏–∞–ª"}),e.data.releaseDate&&a.jsx("p",{className:s.mediaCardYear,children:new Date(e.data.releaseDate).getFullYear()}),e.data.overview&&a.jsx("p",{className:s.mediaCardOverview,children:e.data.overview.length>150?`${e.data.overview.substring(0,150)}...`:e.data.overview}),e.data.voteAverage>0&&a.jsxs("div",{className:s.mediaCardRating,children:["‚≠ê ",e.data.voteAverage.toFixed(1)]})]})]})},`${e.type}-${e.data.id||e.data.tmdbId}-${x}`)})}):a.jsxs("div",{className:s.empty,children:[a.jsx("p",{children:"–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"}),a.jsx("p",{className:s.emptyHint,children:"–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã"})]})})]})})};export{te as default};
//# sourceMappingURL=SearchPage-DiwW6pQ1.js.map
