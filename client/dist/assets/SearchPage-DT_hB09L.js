import{b as z,a as b,u as $,c as v,r as l,s as I,j as a}from"./index-DPQ5xN5C.js";import{U as P}from"./UserPageLayout-BKV1caGZ.js";const T="_searchPage_15sjz_3",w="_header_15sjz_19",B="_title_15sjz_27",S="_searchForm_15sjz_43",U="_searchInput_15sjz_55",A="_searchButton_15sjz_97",F="_query_15sjz_143",R="_subtitle_15sjz_151",q="_filters_15sjz_163",k="_filterButton_15sjz_177",D="_active_15sjz_211",L="_results_15sjz_225",M="_loading_15sjz_235",Y="_spinner_15sjz_253",E="_error_15sjz_287",H="_errorMessage_15sjz_299",O="_empty_15sjz_313",W="_emptyHint_15sjz_325",G="_resultsList_15sjz_337",J="_resultCard_15sjz_351",K="_userCard_15sjz_383",Q="_userAvatar_15sjz_395",V="_userCardInfo_15sjz_411",X="_userCardName_15sjz_419",Z="_userCardType_15sjz_433",ee="_userCardUsername_15sjz_445",ae="_mediaCard_15sjz_457",se="_mediaPoster_15sjz_467",te="_mediaCardInfo_15sjz_483",re="_mediaCardTitle_15sjz_495",ie="_mediaCardType_15sjz_511",de="_mediaCardYear_15sjz_523",ne="_mediaCardOverview_15sjz_535",ce="_mediaCardRating_15sjz_551",s={searchPage:T,header:w,title:B,searchForm:S,searchInput:U,searchButton:A,query:F,subtitle:R,filters:q,filterButton:k,active:D,results:L,loading:M,spinner:Y,error:E,errorMessage:H,empty:O,emptyHint:W,resultsList:G,resultCard:J,userCard:K,userAvatar:Q,userCardInfo:V,userCardName:X,userCardType:Z,userCardUsername:ee,mediaCard:ae,mediaPoster:se,mediaCardInfo:te,mediaCardTitle:re,mediaCardType:ie,mediaCardYear:de,mediaCardOverview:ne,mediaCardRating:ce},me=()=>{const _=z(),h=b(),[C,x]=$(),{searchResults:i,loading:g,error:u}=v(e=>e.media),{user:d}=v(e=>e.auth),t=C.get("q")||"",[o,p]=l.useState(t),[r,n]=l.useState("all");l.useEffect(()=>{p(t)},[t]),l.useEffect(()=>{t.trim()&&_(I({query:t,filters:{}}))},[t,_]);const f=e=>{e.preventDefault(),o.trim()&&x({q:o.trim()})},m=i.filter(e=>r==="all"?!0:r==="users"?e.type==="user":r==="movies"?e.type==="movie":r==="tv"?e.type==="tv":!0),N=e=>{e.type==="user"?h(`/user/${e.data.id}`):h(`/media/${e.data.mediaType}/${e.data.tmdbId}`)},c={all:i.length,users:i.filter(e=>e.type==="user").length,movies:i.filter(e=>e.type==="movie").length,tv:i.filter(e=>e.type==="tv").length};return a.jsx(P,{user:d,narrowSidebar:!0,children:a.jsxs("div",{className:s.searchPage,children:[a.jsxs("div",{className:s.header,children:[a.jsx("h1",{className:s.title,children:"–ü–æ–∏—Å–∫"}),a.jsxs("form",{onSubmit:f,className:s.searchForm,children:[a.jsx("input",{type:"text",value:o,onChange:e=>p(e.target.value),placeholder:"–ü–æ–∏—Å–∫ —Ñ–∏–ª—å–º–æ–≤, —Å–µ—Ä–∏–∞–ª–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...",className:s.searchInput,autoFocus:!0}),a.jsx("button",{type:"submit",className:s.searchButton,children:"üîç –ù–∞–π—Ç–∏"})]}),t&&a.jsxs("p",{className:s.subtitle,children:["–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è: ",a.jsxs("span",{className:s.query,children:['"',t,'"']})," ‚Äî –Ω–∞–π–¥–µ–Ω–æ: ",m.length]})]}),a.jsxs("div",{className:s.filters,children:[a.jsxs("button",{className:`${s.filterButton} ${r==="all"?s.active:""}`,onClick:()=>n("all"),children:["–í—Å–µ (",c.all,")"]}),a.jsxs("button",{className:`${s.filterButton} ${r==="users"?s.active:""}`,onClick:()=>n("users"),children:["–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (",c.users,")"]}),a.jsxs("button",{className:`${s.filterButton} ${r==="movies"?s.active:""}`,onClick:()=>n("movies"),children:["–§–∏–ª—å–º—ã (",c.movies,")"]}),a.jsxs("button",{className:`${s.filterButton} ${r==="tv"?s.active:""}`,onClick:()=>n("tv"),children:["–°–µ—Ä–∏–∞–ª—ã (",c.tv,")"]})]}),a.jsx("div",{className:s.results,children:g?a.jsxs("div",{className:s.loading,children:[a.jsx("div",{className:s.spinner}),a.jsx("p",{children:"–ü–æ–∏—Å–∫..."})]}):u?a.jsxs("div",{className:s.error,children:[a.jsx("p",{children:"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ"}),a.jsx("p",{className:s.errorMessage,children:u.message||"–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑"})]}):m.length>0?a.jsx("div",{className:s.resultsList,children:m.map((e,y)=>{var j;return a.jsx("div",{className:s.resultCard,onClick:()=>N(e),children:e.type==="user"?a.jsxs("div",{className:s.userCard,children:[a.jsx("img",{src:(j=e.data.avatarUrl)!=null&&j.startsWith("/uploads/")?`http://localhost:1313${e.data.avatarUrl}`:e.data.avatarUrl||"/default-avatar.png",alt:e.data.displayName,className:s.userAvatar}),a.jsxs("div",{className:s.userCardInfo,children:[a.jsx("h3",{className:s.userCardName,children:e.data.displayName}),a.jsx("p",{className:s.userCardType,children:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"}),(d==null?void 0:d.id)===e.data.id&&e.data.telegramUsername&&a.jsxs("p",{className:s.userCardUsername,children:["@",e.data.telegramUsername]})]})]}):a.jsxs("div",{className:s.mediaCard,children:[a.jsx("img",{src:e.data.posterPath?`https://image.tmdb.org/t/p/w185${e.data.posterPath}`:"/default-poster.png",alt:e.data.title,className:s.mediaPoster}),a.jsxs("div",{className:s.mediaCardInfo,children:[a.jsx("h3",{className:s.mediaCardTitle,children:e.data.title}),a.jsx("p",{className:s.mediaCardType,children:e.data.mediaType==="movie"?"üé¨ –§–∏–ª—å–º":"üì∫ –°–µ—Ä–∏–∞–ª"}),e.data.releaseDate&&a.jsx("p",{className:s.mediaCardYear,children:new Date(e.data.releaseDate).getFullYear()}),e.data.overview&&a.jsx("p",{className:s.mediaCardOverview,children:e.data.overview.length>150?`${e.data.overview.substring(0,150)}...`:e.data.overview}),e.data.voteAverage>0&&a.jsxs("div",{className:s.mediaCardRating,children:["‚≠ê ",e.data.voteAverage.toFixed(1)]})]})]})},`${e.type}-${e.data.id||e.data.tmdbId}-${y}`)})}):a.jsxs("div",{className:s.empty,children:[a.jsx("p",{children:"–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"}),a.jsx("p",{className:s.emptyHint,children:"–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã"})]})})]})})};export{me as default};
//# sourceMappingURL=SearchPage-DT_hB09L.js.map
