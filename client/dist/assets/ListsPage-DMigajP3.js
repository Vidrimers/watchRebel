import{b as O,r as c,j as e,v as W,w as z,x as U,a as V,u as q,c as A,m as J,y as K,z as Q}from"./index-DPQ5xN5C.js";import{U as X}from"./UserPageLayout-BKV1caGZ.js";import{u as Y}from"./useConfirm-ByNQs_z1.js";import{M as Z}from"./MediaCard-Cfsv07xe.js";import{C as E}from"./ConfirmDialog-CGWZbxny.js";import{u as ee}from"./useAlert-C1sBKQSI.js";const te="_listManager_oja9_1",se="_header_oja9_9",ae="_title_oja9_27",ne="_createButton_oja9_41",oe="_createForm_oja9_87",ie="_input_oja9_103",le="_formActions_oja9_147",re="_submitButton_oja9_157",ce="_cancelButton_oja9_159",de="_errorMessage_oja9_219",me="_listsContainer_oja9_241",ue="_emptyState_oja9_249",he="_emptyHint_oja9_271",_e="_listGrid_oja9_283",pe="_listCard_oja9_295",ge="_listHeader_oja9_327",je="_listName_oja9_341",xe="_listActions_oja9_359",Ce="_editButton_oja9_371",ve="_deleteButton_oja9_373",Ne="_listInfo_oja9_437",fe="_itemCount_oja9_445",ye="_previewPosters_oja9_459",Be="_previewPoster_oja9_459",Le="_modal_oja9_571",be="_modalContent_oja9_601",we="_modalHeader_oja9_643",Se="_modalClose_oja9_671",Te="_modalActions_oja9_715",a={listManager:te,header:se,title:ae,createButton:ne,createForm:oe,input:ie,formActions:le,submitButton:re,cancelButton:ce,errorMessage:de,listsContainer:me,emptyState:ue,emptyHint:he,listGrid:_e,listCard:pe,listHeader:ge,listName:je,listActions:xe,editButton:Ce,deleteButton:ve,listInfo:Ne,itemCount:fe,previewPosters:ye,previewPoster:Be,modal:Le,modalContent:be,modalHeader:we,modalClose:Se,modalActions:Te},Me=({lists:j,mediaType:m,onListSelect:T})=>{const y=O(),{confirmDialog:I,showConfirm:B}=Y(),[x,C]=c.useState(!1),[g,v]=c.useState(""),[u,l]=c.useState(null),[N,o]=c.useState(null),[L,h]=c.useState(""),M=j.filter(s=>s.mediaType===m),b=async s=>{if(s.preventDefault(),!g.trim()){l("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞");return}try{await y(W({name:g.trim(),mediaType:m})).unwrap(),v(""),C(!1),l(null)}catch(r){l(r.message||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–ø–∏—Å–∫–∞")}},i=async(s,r)=>{if(await B({title:"–£–¥–∞–ª–∏—Ç—å —Å–ø–∏—Å–æ–∫?",message:`–°–ø–∏—Å–æ–∫ "${r}" –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω –≤–º–µ—Å—Ç–µ —Å–æ –≤—Å–µ–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.`,confirmText:"–£–¥–∞–ª–∏—Ç—å",cancelText:"–û—Ç–º–µ–Ω–∞",confirmButtonStyle:"danger"}))try{await y(z(s)).unwrap()}catch(f){l(f.message||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞")}},_=(s,r)=>{o(s),h(r),l(null)},p=()=>{o(null),h(""),l(null)},w=async s=>{if(s.preventDefault(),!L.trim()){l("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞");return}try{await y(U({listId:N,name:L.trim()})).unwrap(),o(null),h(""),l(null)}catch(r){l(r.message||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏ —Å–ø–∏—Å–∫–∞")}},k=()=>{C(!1),v(""),l(null)};return e.jsxs(e.Fragment,{children:[I,e.jsxs("div",{className:a.listManager,children:[e.jsxs("div",{className:a.header,children:[e.jsx("h2",{className:a.title,children:m==="movie"?"–°–ø–∏—Å–∫–∏ —Ñ–∏–ª—å–º–æ–≤":"–°–ø–∏—Å–∫–∏ —Å–µ—Ä–∏–∞–ª–æ–≤"}),!x&&e.jsx("button",{className:a.createButton,onClick:()=>C(!0),title:"–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–ø–∏—Å–æ–∫",children:"+ –°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫"})]}),x&&e.jsxs("form",{className:a.createForm,onSubmit:b,children:[e.jsx("input",{type:"text",className:a.input,placeholder:"–ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –û—Ç–ª–∏—á–Ω—ã–µ, –°—Ä–µ–¥–Ω–∏–µ, –û—Ç—Å—Ç–æ–π)",value:g,onChange:s=>v(s.target.value),autoFocus:!0,maxLength:50}),e.jsxs("div",{className:a.formActions,children:[e.jsx("button",{type:"submit",className:a.submitButton,children:"–°–æ–∑–¥–∞—Ç—å"}),e.jsx("button",{type:"button",className:a.cancelButton,onClick:k,children:"–û—Ç–º–µ–Ω–∞"})]})]}),u&&e.jsx("div",{className:a.errorMessage,children:u}),e.jsx("div",{className:a.listsContainer,children:M.length===0?e.jsxs("div",{className:a.emptyState,children:[e.jsx("p",{children:"–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–ø–∏—Å–∫–æ–≤"}),e.jsx("p",{className:a.emptyHint,children:"–°–æ–∑–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Å–≤–æ—é –∫–æ–ª–ª–µ–∫—Ü–∏—é"})]}):e.jsx("div",{className:a.listGrid,children:M.map(s=>{var r,S,f,H;return e.jsxs("div",{className:a.listCard,onClick:()=>T&&T(s),children:[e.jsxs("div",{className:a.listHeader,children:[e.jsx("h3",{className:a.listName,children:s.name}),e.jsxs("div",{className:a.listActions,children:[e.jsx("button",{className:a.editButton,onClick:d=>{d.stopPropagation(),_(s.id,s.name)},title:"–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫",children:"‚úèÔ∏è"}),e.jsx("button",{className:a.deleteButton,onClick:d=>{d.stopPropagation(),i(s.id,s.name)},title:"–£–¥–∞–ª–∏—Ç—å —Å–ø–∏—Å–æ–∫",children:"√ó"})]})]}),e.jsx("div",{className:a.listInfo,children:e.jsxs("span",{className:a.itemCount,children:[((r=s.items)==null?void 0:r.length)||0," "," ",((S=s.items)==null?void 0:S.length)===1?"—ç–ª–µ–º–µ–Ω—Ç":((f=s.items)==null?void 0:f.length)>1&&((H=s.items)==null?void 0:H.length)<5?"—ç–ª–µ–º–µ–Ω—Ç–∞":"—ç–ª–µ–º–µ–Ω—Ç–æ–≤"]})}),s.items&&s.items.length>0&&e.jsx("div",{className:a.previewPosters,children:s.items.slice(0,3).map((d,P)=>e.jsx("div",{className:a.previewPoster,children:d.posterPath&&e.jsx("img",{src:`https://image.tmdb.org/t/p/w92${d.posterPath}`,alt:d.title,loading:"lazy"})},P))})]},s.id)})})}),N&&e.jsx("div",{className:a.modal,onClick:p,children:e.jsxs("div",{className:a.modalContent,onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:a.modalHeader,children:[e.jsx("h3",{children:"–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫"}),e.jsx("button",{className:a.modalClose,onClick:p,title:"–ó–∞–∫—Ä—ã—Ç—å",children:"√ó"})]}),e.jsxs("form",{onSubmit:w,children:[e.jsx("input",{type:"text",className:a.input,placeholder:"–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞",value:L,onChange:s=>h(s.target.value),autoFocus:!0,maxLength:50}),e.jsxs("div",{className:a.modalActions,children:[e.jsx("button",{type:"submit",className:a.submitButton,children:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"}),e.jsx("button",{type:"button",className:a.cancelButton,onClick:p,children:"–û—Ç–º–µ–Ω–∞"})]})]})]})})]})]})},ke="_listsPage_2h77u_1",He="_pageHeader_2h77u_9",Pe="_pageTitle_2h77u_27",Ie="_mediaTypeToggle_2h77u_43",Ae="_toggleButton_2h77u_61",De="_active_2h77u_97",$e="_loadingContainer_2h77u_111",Fe="_errorMessage_2h77u_113",Ge="_errorContainer_2h77u_149",Re="_listContent_2h77u_169",Ee="_listContentHeader_2h77u_183",Oe="_backButton_2h77u_191",We="_listContentTitle_2h77u_235",ze="_listContentCount_2h77u_249",Ue="_mediaGrid_2h77u_263",Ve="_emptyList_2h77u_279",qe="_emptyHint_2h77u_301",Je="_searchLink_2h77u_311",Ke="_mediaCardWrapper_2h77u_337",Qe="_itemActions_2h77u_353",Xe="_moveButton_2h77u_363",Ye="_deleteButton_2h77u_365",Ze="_dialogContent_2h77u_449",et="_listSelect_2h77u_473",tt="_noListsMessage_2h77u_517",n={listsPage:ke,pageHeader:He,pageTitle:Pe,mediaTypeToggle:Ie,toggleButton:Ae,active:De,loadingContainer:$e,errorMessage:Fe,errorContainer:Ge,listContent:Re,listContentHeader:Ee,backButton:Oe,listContentTitle:We,listContentCount:ze,mediaGrid:Ue,emptyList:Ve,emptyHint:qe,searchLink:Je,mediaCardWrapper:Ke,itemActions:Qe,moveButton:Xe,deleteButton:Ye,dialogContent:Ze,listSelect:et,noListsMessage:tt},rt=()=>{var D,$,F,G;const j=O();V();const{showAlert:m}=ee(),[T,y]=q(),{user:I,isAuthenticated:B}=A(t=>t.auth),{customLists:x,loading:C,error:g}=A(t=>t.lists),{episodeProgress:v}=A(t=>t.lists),u=T.get("type")||"movie",[l,N]=c.useState(null),o=l?x.find(t=>t.id===l):null,[L,h]=c.useState(!1),[M,b]=c.useState(!1),[i,_]=c.useState(null),[p,w]=c.useState("");c.useEffect(()=>{B&&j(J())},[B,j]);const k=t=>{y({type:t}),N(null)},s=t=>{N(t.id)},r=()=>{N(null)},S=t=>{_(t),h(!0)},f=t=>{_(t),b(!0)},H=async()=>{if(!(!i||!p||!o))try{await j(K({fromListId:o.id,itemId:i.id,toListId:p,media:{tmdbId:i.tmdbId,mediaType:i.mediaType}})).unwrap(),h(!1),w(""),_(null),await m({title:"–£—Å–ø–µ—à–Ω–æ!",message:`"${i.title}" –ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ –¥—Ä—É–≥–æ–π —Å–ø–∏—Å–æ–∫`,type:"success"})}catch(t){console.error("–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è:",t),await m({title:"–û—à–∏–±–∫–∞",message:t.error||"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.",type:"error"})}},d=async()=>{if(!(!i||!o))try{await j(Q({listId:o.id,itemId:i.id})).unwrap(),b(!1),_(null),await m({title:"–£—Å–ø–µ—à–Ω–æ!",message:`"${i.title}" —É–¥–∞–ª–µ–Ω –∏–∑ —Å–ø–∏—Å–∫–∞`,type:"success"})}catch(t){console.error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:",t),await m({title:"–û—à–∏–±–∫–∞",message:"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.",type:"error"})}},P=l?x.filter(t=>t.id!==l&&t.mediaType===(o==null?void 0:o.mediaType)):[];return B?e.jsxs(X,{user:I,children:[e.jsxs("div",{className:n.listsPage,children:[e.jsxs("div",{className:n.pageHeader,children:[e.jsx("h1",{className:n.pageTitle,children:"–ú–æ–∏ —Å–ø–∏—Å–∫–∏"}),e.jsxs("div",{className:n.mediaTypeToggle,children:[e.jsx("button",{className:`${n.toggleButton} ${u==="movie"?n.active:""}`,onClick:()=>k("movie"),children:"üé¨ –§–∏–ª—å–º—ã"}),e.jsx("button",{className:`${n.toggleButton} ${u==="tv"?n.active:""}`,onClick:()=>k("tv"),children:"üì∫ –°–µ—Ä–∏–∞–ª—ã"})]})]}),C&&e.jsx("div",{className:n.loadingContainer,children:e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–æ–≤..."})}),g&&e.jsx("div",{className:n.errorMessage,children:e.jsxs("p",{children:["–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ",g.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"]})}),!C&&!g&&e.jsx(e.Fragment,{children:o?e.jsxs("div",{className:n.listContent,children:[e.jsxs("div",{className:n.listContentHeader,children:[e.jsx("button",{className:n.backButton,onClick:r,children:"‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫–∞–º"}),e.jsx("h2",{className:n.listContentTitle,children:o.name}),e.jsxs("p",{className:n.listContentCount,children:[((D=o.items)==null?void 0:D.length)||0," "," ",(($=o.items)==null?void 0:$.length)===1?"—ç–ª–µ–º–µ–Ω—Ç":((F=o.items)==null?void 0:F.length)>1&&((G=o.items)==null?void 0:G.length)<5?"—ç–ª–µ–º–µ–Ω—Ç–∞":"—ç–ª–µ–º–µ–Ω—Ç–æ–≤"]})]}),o.items&&o.items.length>0?e.jsx("div",{className:n.mediaGrid,children:o.items.map(t=>{var R;return e.jsxs("div",{className:n.mediaCardWrapper,children:[e.jsx(Z,{media:t,showProgress:t.mediaType==="tv",progress:(R=v[t.tmdbId])==null?void 0:R[v[t.tmdbId].length-1]}),e.jsxs("div",{className:n.itemActions,children:[e.jsx("button",{className:n.moveButton,onClick:()=>S(t),title:"–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –¥—Ä—É–≥–æ–π —Å–ø–∏—Å–æ–∫",children:"‚Üí"}),e.jsx("button",{className:n.deleteButton,onClick:()=>f(t),title:"–£–¥–∞–ª–∏—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞",children:"üóëÔ∏è"})]})]},t.tmdbId)})}):e.jsxs("div",{className:n.emptyList,children:[e.jsx("p",{children:"–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç"}),e.jsxs("p",{className:n.emptyHint,children:["–î–æ–±–∞–≤—å—Ç–µ ",u==="movie"?"—Ñ–∏–ª—å–º—ã":"—Å–µ—Ä–∏–∞–ª—ã"," —á–µ—Ä–µ–∑"," ",e.jsx("a",{href:"/catalog",className:n.searchLink,children:"–∫–∞—Ç–∞–ª–æ–≥"})," ","–∏–ª–∏"," ",e.jsx("a",{href:"/search",className:n.searchLink,children:"–ø–æ–∏—Å–∫"})]})]})]}):e.jsx(Me,{lists:x,mediaType:u,onListSelect:s})})]}),e.jsx(E,{isOpen:L,title:"–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –¥—Ä—É–≥–æ–π —Å–ø–∏—Å–æ–∫",message:e.jsxs("div",{className:n.dialogContent,children:[e.jsxs("p",{children:['–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å "',i==null?void 0:i.title,'" –≤:']}),e.jsxs("select",{value:p,onChange:t=>w(t.target.value),className:n.listSelect,children:[e.jsx("option",{value:"",children:"–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫"}),P.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),P.length===0&&e.jsxs("p",{className:n.noListsMessage,children:["–ù–µ—Ç –¥—Ä—É–≥–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –¥–ª—è ",u==="movie"?"—Ñ–∏–ª—å–º–æ–≤":"—Å–µ—Ä–∏–∞–ª–æ–≤"]})]}),onConfirm:H,onCancel:()=>{h(!1),w(""),_(null)},confirmText:"–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å",cancelText:"–û—Ç–º–µ–Ω–∞",confirmButtonStyle:"primary",confirmDisabled:!p}),e.jsx(E,{isOpen:M,title:"–£–¥–∞–ª–∏—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞",message:`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å "${i==null?void 0:i.title}" –∏–∑ —Å–ø–∏—Å–∫–∞ "${o==null?void 0:o.name}"?`,onConfirm:d,onCancel:()=>{b(!1),_(null)},confirmText:"–£–¥–∞–ª–∏—Ç—å",cancelText:"–û—Ç–º–µ–Ω–∞",confirmButtonStyle:"danger"})]}):e.jsx("div",{className:n.errorContainer,children:e.jsx("p",{children:"–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è"})})};export{rt as default};
//# sourceMappingURL=ListsPage-DMigajP3.js.map
