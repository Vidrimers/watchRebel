{"version":3,"file":"FeedPage-B-2lzbgy.js","sources":["../../src/pages/FeedPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAppSelector } from '../hooks/useAppSelector';\r\nimport UserPageLayout from '../components/Layout/UserPageLayout';\r\nimport WallPost from '../components/Wall/WallPost';\r\nimport api from '../services/api';\r\nimport styles from './FeedPage.module.css';\r\n\r\n/**\r\n * –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–µ–Ω—Ç—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥—Ä—É–∑–µ–π\r\n * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ—Å—Ç—ã –æ—Ç –≤—Å–µ—Ö –¥—Ä—É–∑–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\r\n */\r\nconst FeedPage = () => {\r\n  const { user } = useAppSelector((state) => state.auth);\r\n  const [posts, setPosts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–µ–Ω—Ç—ã\r\n  const fetchFeed = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      setError(null);\r\n      const response = await api.get(`/feed/${user.id}`);\r\n      setPosts(response.data);\r\n    } catch (err) {\r\n      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–µ–Ω—Ç—ã:', err);\r\n      setError(err.response?.data?.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–µ–Ω—Ç—É');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // –ó–∞–≥—Ä—É–∑–∫–∞ –ª–µ–Ω—Ç—ã –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞\r\n  useEffect(() => {\r\n    fetchFeed();\r\n  }, [user]);\r\n\r\n  // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–µ–Ω—Ç—ã –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      fetchFeed();\r\n    }, 30000); // 30 —Å–µ–∫—É–Ω–¥\r\n\r\n    return () => clearInterval(interval);\r\n  }, [user]);\r\n\r\n  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∞–∫—Ü–∏–∏ - –æ–±–Ω–æ–≤–ª—è–µ–º –ª–µ–Ω—Ç—É\r\n  const handleReactionAdded = () => {\r\n    fetchFeed();\r\n  };\r\n\r\n  return (\r\n    <UserPageLayout>\r\n      <div className={styles.feedPage}>\r\n        <div className={styles.header}>\r\n          <h1 className={styles.title}>üì∞ –õ–µ–Ω—Ç–∞ –¥—Ä—É–∑–µ–π</h1>\r\n        </div>\r\n\r\n        {loading && posts.length === 0 ? (\r\n          <div className={styles.loading}>\r\n            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ª–µ–Ω—Ç—ã...</p>\r\n          </div>\r\n        ) : error ? (\r\n          <div className={styles.error}>\r\n            <p>‚ùå {error}</p>\r\n            <button \r\n              className={styles.retryButton}\r\n              onClick={fetchFeed}\r\n            >\r\n              –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞\r\n            </button>\r\n          </div>\r\n        ) : posts.length === 0 ? (\r\n          <div className={styles.emptyState}>\r\n            <p className={styles.emptyIcon}>üì≠</p>\r\n            <h2>–õ–µ–Ω—Ç–∞ –ø—É—Å—Ç–∞</h2>\r\n            <p className={styles.emptyHint}>\r\n              –î–æ–±–∞–≤—å—Ç–µ –¥—Ä—É–∑–µ–π, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–¥–µ—Å—å\r\n            </p>\r\n            <a href=\"/friends\" className={styles.findFriendsButton}>\r\n              –ù–∞–π—Ç–∏ –¥—Ä—É–∑–µ–π\r\n            </a>\r\n          </div>\r\n        ) : (\r\n          <div className={styles.postsList}>\r\n            {posts.map((post) => {\r\n              // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞\r\n              const isAnnouncement = post.content?.startsWith('üì¢ –û–±—ä—è–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:');\r\n              \r\n              return (\r\n                <div key={post.id} className={styles.postWrapper}>\r\n                  {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ –ø–æ—Å—Ç–∞ (–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π) */}\r\n                  {!isAnnouncement && (\r\n                    <div className={styles.postAuthor}>\r\n                      <a \r\n                        href={`/user/${post.userId}`}\r\n                        className={styles.authorLink}\r\n                      >\r\n                        {post.author?.avatarUrl && (\r\n                          <img \r\n                            src={`${import.meta.env.VITE_API_URL || 'http://localhost:3000'}${post.author.avatarUrl}`}\r\n                            alt={post.author.displayName}\r\n                            className={styles.authorAvatar}\r\n                            onError={(e) => {\r\n                              e.target.style.display = 'none';\r\n                            }}\r\n                          />\r\n                        )}\r\n                        <span className={styles.authorName}>\r\n                          {post.author?.displayName || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}\r\n                        </span>\r\n                      </a>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* –°–∞–º –ø–æ—Å—Ç */}\r\n                  <WallPost \r\n                    post={post}\r\n                    isOwnProfile={false}\r\n                    onReactionChange={handleReactionAdded}\r\n                  />\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </UserPageLayout>\r\n  );\r\n};\r\n\r\nexport default FeedPage;\r\n"],"names":["FeedPage","user","useAppSelector","state","posts","setPosts","useState","loading","setLoading","error","setError","fetchFeed","response","api","err","_b","_a","useEffect","interval","handleReactionAdded","UserPageLayout","jsxs","styles","jsx","post","isAnnouncement","e","_c","WallPost"],"mappings":"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"}