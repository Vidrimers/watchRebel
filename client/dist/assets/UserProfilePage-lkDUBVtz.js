import{c as q,r as i,d as L,j as e,b as E,a as M,e as G,f as O,g as V,h as W,i as K}from"./index-C3TbUOD_.js";import{U as Y,a as J}from"./UserPageLayout-D6-bMz6K.js";import{u as H}from"./useAlert-ze2R9Yyq.js";import{u as U}from"./useConfirm-C-3tHhk9.js";const Q="_referralStats_1q298_1",X="_statsHeader_1q298_17",Z="_statsTitle_1q298_31",ee="_statsCount_1q298_45",te="_countNumber_1q298_65",se="_countLabel_1q298_77",ae="_toggleButton_1q298_89",ne="_referralsList_1q298_125",re="_referralsItems_1q298_137",oe="_referralItem_1q298_149",le="_referralAvatar_1q298_179",ie="_avatarPlaceholder_1q298_209",ce="_referralInfo_1q298_233",de="_referralName_1q298_241",me="_referralUsername_1q298_255",ue="_referralDate_1q298_267",_e="_emptyMessage_1q298_279",fe="_loading_1q298_295",he="_error_1q298_309",u={referralStats:Q,statsHeader:X,statsTitle:Z,statsCount:ee,countNumber:te,countLabel:se,toggleButton:ae,referralsList:ne,referralsItems:re,referralItem:oe,referralAvatar:le,avatarPlaceholder:ie,referralInfo:ce,referralName:de,referralUsername:me,referralDate:ue,emptyMessage:_e,loading:fe,error:he},pe=({userId:t})=>{const{user:n}=q(s=>s.auth),[c,x]=i.useState(null),[d,o]=i.useState(0),[_,N]=i.useState([]),[v,p]=i.useState(!0),[f,h]=i.useState(!1),[l,S]=i.useState(null),b=(n==null?void 0:n.id)===t;i.useEffect(()=>{b&&g()},[t,b]);const g=async()=>{var s,C,D;try{p(!0),S(null);const k=await L.get(`/users/${t}/referral-code`);x(k.data.referralCode),o(k.data.referralsCount||0),p(!1)}catch(k){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:",k),((s=k.response)==null?void 0:s.status)===404||((D=(C=k.response)==null?void 0:C.data)==null?void 0:D.code)==="USER_NOT_FOUND"?(x(null),o(0),p(!1)):(S("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É"),p(!1))}},y=async()=>{var s;try{const C=await L.get(`/users/${t}/referrals`);N(C.data)}catch(C){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:",C),((s=C.response)==null?void 0:s.status)===404?N([]):S("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤")}},R=async()=>{!f&&_.length===0&&await y(),h(!f)};return b?v?e.jsx("div",{className:u.referralStats,children:e.jsx("p",{className:u.loading,children:"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏..."})}):l?e.jsx("div",{className:u.referralStats,children:e.jsx("p",{className:u.error,children:l})}):e.jsxs("div",{className:u.referralStats,children:[e.jsxs("div",{className:u.statsHeader,children:[e.jsx("h3",{className:u.statsTitle,children:"üë• –ü—Ä–∏–≥–ª–∞—à–µ–Ω–Ω—ã–µ –¥—Ä—É–∑—å—è"}),e.jsxs("div",{className:u.statsCount,children:[e.jsx("span",{className:u.countNumber,children:d}),e.jsx("span",{className:u.countLabel,children:"–¥—Ä—É–∑–µ–π"})]})]}),d>0&&e.jsx("button",{className:u.toggleButton,onClick:R,children:f?"‚ñº –°–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫":"‚ñ∂ –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫"}),f&&e.jsx("div",{className:u.referralsList,children:_.length===0?e.jsx("p",{className:u.emptyMessage,children:"–ó–∞–≥—Ä—É–∑–∫–∞..."}):e.jsx("ul",{className:u.referralsItems,children:_.map(s=>e.jsxs("li",{className:u.referralItem,children:[e.jsx("div",{className:u.referralAvatar,children:s.avatarUrl?e.jsx("img",{src:s.avatarUrl.startsWith("/uploads/")?`http://localhost:1313${s.avatarUrl}`:s.avatarUrl,alt:s.displayName}):e.jsx("div",{className:u.avatarPlaceholder,children:s.displayName.charAt(0).toUpperCase()})}),e.jsxs("div",{className:u.referralInfo,children:[e.jsx("p",{className:u.referralName,children:s.displayName}),s.telegramUsername&&e.jsxs("p",{className:u.referralUsername,children:["@",s.telegramUsername]}),e.jsxs("p",{className:u.referralDate,children:["–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è: ",new Date(s.referralCreatedAt).toLocaleDateString("ru-RU")]})]})]},s.id))})}),d===0&&e.jsx("p",{className:u.emptyMessage,children:"–í—ã –µ—â–µ –Ω–µ –ø—Ä–∏–≥–ª–∞—Å–∏–ª–∏ –¥—Ä—É–∑–µ–π. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Telegram –±–æ—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏!"})]}):null},je="_moderationPanel_7rr7w_1",xe="_title_7rr7w_17",Ne="_actions_7rr7w_29",ve="_button_7rr7w_41",ge="_banPostsButton_7rr7w_71",be="_permanentBanButton_7rr7w_89",we="_unbanButton_7rr7w_107",ye="_modalOverlay_7rr7w_127",Ce="_modal_7rr7w_127",Be="_modalTitle_7rr7w_177",Te="_error_7rr7w_189",Pe="_formGroup_7rr7w_209",Se="_textarea_7rr7w_231",ke="_input_7rr7w_233",Ie="_durationPresets_7rr7w_281",De="_presetButton_7rr7w_295",$e="_modalActions_7rr7w_339",Le="_cancelButton_7rr7w_351",r={moderationPanel:je,title:xe,actions:Ne,button:ve,banPostsButton:ge,permanentBanButton:be,unbanButton:we,modalOverlay:ye,modal:Ce,modalTitle:Be,error:Te,formGroup:Pe,textarea:Se,input:ke,durationPresets:Ie,presetButton:De,modalActions:$e,cancelButton:Le};function Re({userId:t,isAdmin:n,onModerationAction:c}){const{alertDialog:x,showAlert:d}=H(),{confirmDialog:o,showConfirm:_}=U(),[N,v]=i.useState(!1),[p,f]=i.useState(null),[h,l]=i.useState(""),[S,b]=i.useState(1440),[g,y]=i.useState(!1),[R,s]=i.useState(null);if(!n)return null;const C=async()=>{var w,B;if(!h.trim()){s("–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏");return}if(S<=0){s("–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0");return}y(!0),s(null);try{await L.post(`/admin/users/${t}/ban-posts`,{reason:h.trim(),durationMinutes:S}),v(!1),l(""),b(1440),c&&c("post_ban"),await d({title:"–£—Å–ø–µ—à–Ω–æ",message:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∑–∞–ø—Ä–µ—â–µ–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ—Å—Ç—ã",type:"success"})}catch(T){console.error("–û—à–∏–±–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ—Å—Ç–æ–≤:",T),s(((B=(w=T.response)==null?void 0:w.data)==null?void 0:B.error)||"–û—à–∏–±–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ—Å—Ç–æ–≤")}finally{y(!1)}},D=async()=>{var B,T;if(!h.trim()){s("–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏");return}if(await _({title:"–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞",message:"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –Ω–∞–≤—Å–µ–≥–¥–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?",confirmText:"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å",cancelText:"–û—Ç–º–µ–Ω–∞",confirmButtonStyle:"danger"})){y(!0),s(null);try{await L.post(`/admin/users/${t}/ban-permanent`,{reason:h.trim()}),v(!1),l(""),c&&c("permanent_ban"),await d({title:"–£—Å–ø–µ—à–Ω–æ",message:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞–≤—Å–µ–≥–¥–∞",type:"success"})}catch($){console.error("–û—à–∏–±–∫–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:",$),s(((T=(B=$.response)==null?void 0:B.data)==null?void 0:T.error)||"–û—à–∏–±–∫–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏")}finally{y(!1)}}},k=async()=>{var B,T;if(await _({title:"–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",message:"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?",confirmText:"–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å",cancelText:"–û—Ç–º–µ–Ω–∞",confirmButtonStyle:"success"})){y(!0),s(null);try{await L.post(`/admin/users/${t}/unban`),c&&c("unban"),await d({title:"–£—Å–ø–µ—à–Ω–æ",message:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω",type:"success"})}catch($){console.error("–û—à–∏–±–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:",$),s(((T=(B=$.response)==null?void 0:B.data)==null?void 0:T.error)||"–û—à–∏–±–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏")}finally{y(!1)}}},A=()=>{f("posts"),v(!0),s(null)},m=()=>{f("permanent"),v(!0),s(null)},j=()=>{v(!1),f(null),l(""),b(1440),s(null)};return e.jsxs(e.Fragment,{children:[x,o,e.jsxs("div",{className:r.moderationPanel,children:[e.jsx("h3",{className:r.title,children:"‚ö†Ô∏è –ú–æ–¥–µ—Ä–∞—Ü–∏—è"}),e.jsxs("div",{className:r.actions,children:[e.jsx("button",{className:`${r.button} ${r.banPostsButton}`,onClick:A,disabled:g,children:"üö´ –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –ø–æ—Å—Ç—ã"}),e.jsx("button",{className:`${r.button} ${r.permanentBanButton}`,onClick:m,disabled:g,children:"‚õî –ó–∞–±–∞–Ω–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞"}),e.jsx("button",{className:`${r.button} ${r.unbanButton}`,onClick:k,disabled:g,children:"‚úÖ –†–∞–∑–±–∞–Ω–∏—Ç—å"})]}),N&&e.jsx("div",{className:r.modalOverlay,onClick:j,children:e.jsxs("div",{className:r.modal,onClick:w=>w.stopPropagation(),children:[e.jsx("h3",{className:r.modalTitle,children:p==="posts"?"üö´ –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –ø–æ—Å—Ç—ã":"‚õî –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞"}),R&&e.jsx("div",{className:r.error,children:R}),e.jsxs("div",{className:r.formGroup,children:[e.jsx("label",{htmlFor:"reason",children:"–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:"}),e.jsx("textarea",{id:"reason",className:r.textarea,value:h,onChange:w=>l(w.target.value),placeholder:"–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏...",rows:4,disabled:g})]}),p==="posts"&&e.jsxs("div",{className:r.formGroup,children:[e.jsx("label",{htmlFor:"duration",children:"–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω—É—Ç—ã):"}),e.jsx("input",{id:"duration",type:"number",className:r.input,value:S,onChange:w=>b(parseInt(w.target.value)||0),min:"1",disabled:g}),e.jsxs("div",{className:r.durationPresets,children:[e.jsx("button",{className:r.presetButton,onClick:()=>b(60),disabled:g,children:"1 —á–∞—Å"}),e.jsx("button",{className:r.presetButton,onClick:()=>b(1440),disabled:g,children:"1 –¥–µ–Ω—å"}),e.jsx("button",{className:r.presetButton,onClick:()=>b(10080),disabled:g,children:"1 –Ω–µ–¥–µ–ª—è"}),e.jsx("button",{className:r.presetButton,onClick:()=>b(43200),disabled:g,children:"1 –º–µ—Å—è—Ü"})]})]}),e.jsxs("div",{className:r.modalActions,children:[e.jsx("button",{className:`${r.button} ${r.cancelButton}`,onClick:j,disabled:g,children:"–û—Ç–º–µ–Ω–∞"}),e.jsx("button",{className:`${r.button} ${p==="posts"?r.banPostsButton:r.permanentBanButton}`,onClick:p==="posts"?C:D,disabled:g,children:g?"–û–±—Ä–∞–±–æ—Ç–∫–∞...":"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"})]})]})})]})]})}const ze="_reactionPicker_wifv9_3",Ae="_pickerHeader_wifv9_57",qe="_pickerTitle_wifv9_75",Fe="_closeButton_wifv9_87",Ee="_emojiGrid_wifv9_133",He="_emojiButton_wifv9_145",z={reactionPicker:ze,pickerHeader:Ae,pickerTitle:qe,closeButton:Fe,emojiGrid:Ee,emojiButton:He},Ue=({onSelect:t,onClose:n})=>{const c=i.useRef(null),x=["‚ù§Ô∏è","üëç","üòÇ","üòÆ","üò¢","üò°","üî•","üëè","üéâ","üíØ","ü§î","üòç","ü§©","üòé","ü•≥","üò±","ü§Ø","üëÄ"];i.useEffect(()=>{const o=_=>{c.current&&!c.current.contains(_.target)&&n()};return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[n]),i.useEffect(()=>{const o=_=>{_.key==="Escape"&&n()};return document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}},[n]);const d=o=>{t(o)};return e.jsxs("div",{className:z.reactionPicker,ref:c,children:[e.jsxs("div",{className:z.pickerHeader,children:[e.jsx("span",{className:z.pickerTitle,children:"–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∞–∫—Ü–∏—é"}),e.jsx("button",{className:z.closeButton,onClick:n,"aria-label":"–ó–∞–∫—Ä—ã—Ç—å",children:"√ó"})]}),e.jsx("div",{className:z.emojiGrid,children:x.map(o=>e.jsx("button",{className:z.emojiButton,onClick:()=>d(o),title:o,children:o},o))})]})},Me="_wallPost_9jn6z_3",Ge="_postContent_9jn6z_29",Oe="_textContent_9jn6z_39",Ve="_actionText_9jn6z_59",We="_mediaInfo_9jn6z_73",Ke="_mediaDetails_9jn6z_117",Ye="_mediaTitle_9jn6z_133",Je="_mediaType_9jn6z_149",Qe="_ratingValue_9jn6z_161",Xe="_ratingStars_9jn6z_175",Ze="_ratingNumber_9jn6z_185",et="_reviewText_9jn6z_199",tt="_postFooter_9jn6z_235",st="_postFooterLeft_9jn6z_251",at="_postDate_9jn6z_263",nt="_deleteButton_9jn6z_275",rt="_reactionsContainer_9jn6z_321",ot="_reactionsList_9jn6z_333",lt="_reactionBadge_9jn6z_345",it="_addReactionContainer_9jn6z_379",ct="_addReactionButton_9jn6z_387",a={wallPost:Me,postContent:Ge,textContent:Oe,actionText:Ve,mediaInfo:We,mediaDetails:Ke,mediaTitle:Ye,mediaType:Je,ratingValue:Qe,ratingStars:Xe,ratingNumber:Ze,reviewText:et,postFooter:tt,postFooterLeft:st,postDate:at,deleteButton:nt,reactionsContainer:rt,reactionsList:ot,reactionBadge:lt,addReactionContainer:it,addReactionButton:ct},dt=({post:t,isOwnProfile:n})=>{var k,A;const c=E(),x=M(),d=q(m=>m.auth.user),{confirmDialog:o,showConfirm:_}=U(),{alertDialog:N,showAlert:v}=H(),[p,f]=i.useState(!1),[h,l]=i.useState(!1),S=async m=>{try{await c(O({postId:t.id,emoji:m})).unwrap(),f(!1)}catch(j){console.error("–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∞–∫—Ü–∏–∏:",j)}},b=async()=>{if(await _({title:"–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å?",message:"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.",confirmText:"–£–¥–∞–ª–∏—Ç—å",cancelText:"–û—Ç–º–µ–Ω–∞",confirmButtonStyle:"danger"})){l(!0);try{await c(G(t.id)).unwrap()}catch(j){console.error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞:",j),await v({title:"–û—à–∏–±–∫–∞",message:"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.",type:"error"}),l(!1)}}},g=m=>{const j=new Date(m),w=new Date,B=w-j,T=Math.floor(B/6e4),$=Math.floor(B/36e5),F=Math.floor(B/864e5);return T<1?"—Ç–æ–ª—å–∫–æ —á—Ç–æ":T<60?`${T} –º–∏–Ω –Ω–∞–∑–∞–¥`:$<24?`${$} —á –Ω–∞–∑–∞–¥`:F<7?`${F} –¥ –Ω–∞–∑–∞–¥`:j.toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:j.getFullYear()!==w.getFullYear()?"numeric":void 0})},y=()=>{t.tmdbId&&t.mediaType&&x(`/media/${t.mediaType}/${t.tmdbId}`)},R=()=>{switch(t.postType){case"text":return e.jsx("div",{className:a.textContent,children:e.jsx("p",{children:t.content})});case"media_added":return e.jsxs("div",{className:a.mediaAddedContent,children:[e.jsxs("p",{className:a.actionText,children:["üìå –î–æ–±–∞–≤–∏–ª",n?"":"–∞"," –≤ —Å–ø–∏—Å–æ–∫"]}),t.tmdbId&&e.jsx("div",{className:a.mediaInfo,onClick:y,children:e.jsxs("div",{className:a.mediaDetails,children:[e.jsxs("h4",{className:a.mediaTitle,children:[t.mediaType==="movie"?"–§–∏–ª—å–º":"–°–µ—Ä–∏–∞–ª"," (ID: ",t.tmdbId,")"]}),e.jsx("span",{className:a.mediaType,children:t.mediaType==="movie"?"üé¨ –§–∏–ª—å–º":"üì∫ –°–µ—Ä–∏–∞–ª"})]})})]});case"rating":return e.jsxs("div",{className:a.ratingContent,children:[e.jsxs("p",{className:a.actionText,children:["‚≠ê –û—Ü–µ–Ω–∏–ª",n?"":"–∞"]}),t.tmdbId&&e.jsx("div",{className:a.mediaInfo,onClick:y,children:e.jsxs("div",{className:a.mediaDetails,children:[e.jsxs("h4",{className:a.mediaTitle,children:[t.mediaType==="movie"?"–§–∏–ª—å–º":"–°–µ—Ä–∏–∞–ª"," (ID: ",t.tmdbId,")"]}),e.jsxs("div",{className:a.ratingValue,children:[e.jsx("span",{className:a.ratingStars,children:"‚òÖ"}),e.jsxs("span",{className:a.ratingNumber,children:[t.rating,"/10"]})]})]})})]});case"review":return e.jsxs("div",{className:a.reviewContent,children:[e.jsxs("p",{className:a.actionText,children:["‚úçÔ∏è –ù–∞–ø–∏—Å–∞–ª",n?"":"–∞"," –æ—Ç–∑—ã–≤"]}),t.tmdbId&&e.jsx("div",{className:a.mediaInfo,onClick:y,children:e.jsx("div",{className:a.mediaDetails,children:e.jsxs("h4",{className:a.mediaTitle,children:[t.mediaType==="movie"?"–§–∏–ª—å–º":"–°–µ—Ä–∏–∞–ª"," (ID: ",t.tmdbId,")"]})})}),t.content&&e.jsx("div",{className:a.reviewText,children:e.jsx("p",{children:t.content})})]});default:return null}},s=((k=t.reactions)==null?void 0:k.reduce((m,j)=>(m[j.emoji]||(m[j.emoji]={emoji:j.emoji,count:0,users:[]}),m[j.emoji].count++,m[j.emoji].users.push(j.userId),m),{}))||{},C=Object.values(s),D=(A=t.reactions)==null?void 0:A.find(m=>m.userId===(d==null?void 0:d.id));return e.jsxs(e.Fragment,{children:[o,N,e.jsxs("div",{className:a.wallPost,children:[e.jsx("div",{className:a.postContent,children:R()}),e.jsxs("div",{className:a.postFooter,children:[e.jsxs("div",{className:a.postFooterLeft,children:[e.jsx("span",{className:a.postDate,children:g(t.createdAt)}),n&&d&&t.userId===d.id&&e.jsx("button",{className:a.deleteButton,onClick:b,disabled:h,title:"–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å",children:h?"‚è≥":"üóëÔ∏è"})]}),e.jsxs("div",{className:a.reactionsContainer,children:[C.length>0&&e.jsx("div",{className:a.reactionsList,children:C.map(m=>e.jsxs("span",{className:a.reactionBadge,title:`${m.count} ${m.count===1?"—Ä–µ–∞–∫—Ü–∏—è":"—Ä–µ–∞–∫—Ü–∏–π"}`,children:[m.emoji," ",m.count]},m.emoji))}),!n&&d&&e.jsxs("div",{className:a.addReactionContainer,children:[e.jsx("button",{className:a.addReactionButton,onClick:()=>f(!p),title:D?"–ò–∑–º–µ–Ω–∏—Ç—å —Ä–µ–∞–∫—Ü–∏—é":"–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–∫—Ü–∏—é",children:D?D.emoji:"üòä"}),p&&e.jsx(Ue,{onSelect:S,onClose:()=>f(!1)})]})]})]})]})]})},mt="_wall_1v69n_3",ut="_createPostContainer_1v69n_17",_t="_createPostForm_1v69n_33",ft="_postInput_1v69n_45",ht="_submitButton_1v69n_89",pt="_postsList_1v69n_135",jt="_loading_1v69n_149",xt="_error_1v69n_151",Nt="_emptyState_1v69n_177",vt="_emptyHint_1v69n_205",P={wall:mt,createPostContainer:ut,createPostForm:_t,postInput:ft,submitButton:ht,postsList:pt,loading:jt,error:xt,emptyState:Nt,emptyHint:vt},gt=({userId:t,isOwnProfile:n=!1})=>{const c=E(),{posts:x,loading:d,error:o}=q(l=>l.wall),[_,N]=i.useState(""),[v,p]=i.useState(!1);i.useEffect(()=>{t&&c(V(t))},[c,t]);const f=async l=>{if(l.preventDefault(),!!_.trim()){p(!0);try{await c(W({postType:"text",content:_.trim()})).unwrap(),N("")}catch(S){console.error("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞:",S)}finally{p(!1)}}},h=l=>{l.key==="Enter"&&!l.shiftKey&&(l.preventDefault(),f(l))};return d&&x.length===0?e.jsx("div",{className:P.wall,children:e.jsx("div",{className:P.loading,children:"–ó–∞–≥—Ä—É–∑–∫–∞..."})}):o?e.jsx("div",{className:P.wall,children:e.jsxs("div",{className:P.error,children:["–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–µ–Ω—ã: ",o.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"]})}):e.jsxs("div",{className:P.wall,children:[n&&e.jsx("div",{className:P.createPostContainer,children:e.jsxs("form",{onSubmit:f,className:P.createPostForm,children:[e.jsx("textarea",{className:P.postInput,placeholder:"–ß—Ç–æ —É –≤–∞—Å –Ω–æ–≤–æ–≥–æ?",value:_,onChange:l=>N(l.target.value),onKeyDown:h,rows:3,disabled:v}),e.jsx("button",{type:"submit",className:P.submitButton,disabled:!_.trim()||v,children:v?"–ü—É–±–ª–∏–∫–∞—Ü–∏—è...":"–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å"})]})}),e.jsx("div",{className:P.postsList,children:x.length===0?e.jsxs("div",{className:P.emptyState,children:[e.jsx("p",{children:"–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç–µ–Ω–µ"}),n&&e.jsx("p",{className:P.emptyHint,children:"–î–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å–º –≤ —Å–ø–∏—Å–æ–∫ –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å!"})]}):x.map(l=>e.jsx(dt,{post:l,isOwnProfile:n},l.id))})]})},bt="_profileContainer_27but_1",wt="_profileHeader_27but_9",yt="_profileInfo_27but_31",Ct="_profileName_27but_39",Bt="_wallSection_27but_65",Tt="_sectionTitle_27but_79",Pt="_errorContainer_27but_303",I={profileContainer:bt,profileHeader:wt,profileInfo:yt,profileName:Ct,wallSection:Bt,sectionTitle:Tt,errorContainer:Pt},$t=()=>{const{userId:t}=K(),{user:n,isAuthenticated:c}=q(f=>f.auth),[x,d]=i.useState(null),[o,_]=i.useState(!0),N=(n==null?void 0:n.id)===t,v=(n==null?void 0:n.isAdmin)||!1;i.useEffect(()=>{c&&t&&(async()=>{try{if(_(!0),N){d(n),_(!1);return}const h=await L.get(`/users/${t}`);d(h.data)}catch(h){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:",h)}finally{_(!1)}})()},[t,c,N,n]);const p=async f=>{console.log("–î–µ–π—Å—Ç–≤–∏–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏:",f);try{const h=await L.get(`/users/${t}`);d(h.data)}catch(h){console.error("–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:",h)}};return c?o?e.jsx("div",{className:I.errorContainer,children:e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è..."})}):x?e.jsx(Y,{user:n,children:e.jsxs("div",{className:I.profileContainer,children:[!N&&e.jsxs("div",{className:I.profileHeader,children:[e.jsx(J,{user:x,size:"large",showBanIndicator:!0}),e.jsx("div",{className:I.profileInfo,children:e.jsx("h1",{className:I.profileName,children:x.displayName})})]}),v&&!N&&e.jsx(Re,{userId:t,isAdmin:v,onModerationAction:p}),N&&e.jsx(pe,{userId:t}),e.jsxs("div",{className:I.wallSection,children:[e.jsx("h2",{className:I.sectionTitle,children:"–õ–µ–Ω—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"}),e.jsx(gt,{userId:t,isOwnProfile:N})]})]})}):e.jsx("div",{className:I.errorContainer,children:e.jsx("p",{children:"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω"})}):e.jsx("div",{className:I.errorContainer,children:e.jsx("p",{children:"–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è"})})};export{$t as default};
//# sourceMappingURL=UserProfilePage-lkDUBVtz.js.map
