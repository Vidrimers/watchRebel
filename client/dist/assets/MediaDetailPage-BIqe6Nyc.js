import{r as I,j as e,i as R,k as E,h as D,a as F,b as H,c as B,l as G,m as M,n as U,o as Y,p as z,q as J,t as K}from"./index-DPQ5xN5C.js";import{u as O}from"./useAlert-C1sBKQSI.js";const Q="_episodeTracker_4uxqa_1",V="_title_4uxqa_15",X="_emptyState_4uxqa_29",Z="_seasonsList_4uxqa_41",ee="_seasonItem_4uxqa_53",se="_seasonHeader_4uxqa_75",te="_seasonInfo_4uxqa_103",ae="_seasonTitle_4uxqa_111",ce="_seasonProgress_4uxqa_125",ie="_seasonActions_4uxqa_135",ne="_markAllButton_4uxqa_147",oe="_expandIcon_4uxqa_189",re="_progressBar_4uxqa_201",le="_progressFill_4uxqa_213",de="_episodesList_4uxqa_225",me="_episodeButton_4uxqa_241",_e="_watched_4uxqa_285",ue="_episodeNumber_4uxqa_307",pe="_checkmark_4uxqa_315",he="_lastWatched_4uxqa_329",n={episodeTracker:Q,title:V,emptyState:X,seasonsList:Z,seasonItem:ee,seasonHeader:se,seasonInfo:te,seasonTitle:ae,seasonProgress:ce,seasonActions:ie,markAllButton:ne,expandIcon:oe,progressBar:re,progressFill:le,episodesList:de,episodeButton:me,watched:_e,episodeNumber:ue,checkmark:pe,lastWatched:he},xe=({seriesId:o,seasons:r=[],currentProgress:p=[],onMarkWatched:l})=>{const[j,_]=I.useState(null),s=(c,i)=>p.some(m=>m.seasonNumber===c&&m.episodeNumber===i),w=c=>{const i=p.filter(m=>m.seasonNumber===c).sort((m,x)=>x.episodeNumber-m.episodeNumber);return i.length>0?i[0].episodeNumber:0},v=c=>p.filter(i=>i.seasonNumber===c).length,h=c=>{_(j===c?null:c)},d=(c,i)=>{l&&l(c,i)},f=c=>{if(l)for(let i=1;i<=c.episodeCount;i++)s(c.seasonNumber,i)||l(c.seasonNumber,i)};return!r||r.length===0?e.jsx("div",{className:n.emptyState,children:e.jsx("p",{children:"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–∑–æ–Ω–∞—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞"})}):e.jsxs("div",{className:n.episodeTracker,children:[e.jsx("h3",{className:n.title,children:"–ü—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞"}),e.jsx("div",{className:n.seasonsList,children:r.map((c,i)=>{const m=v(c.seasonNumber),x=j===c.seasonNumber,y=w(c.seasonNumber),k=m/c.episodeCount*100;return e.jsxs("div",{className:n.seasonItem,children:[e.jsxs("div",{className:n.seasonHeader,onClick:()=>h(c.seasonNumber),children:[e.jsxs("div",{className:n.seasonInfo,children:[e.jsx("h4",{className:n.seasonTitle,children:c.name||`–°–µ–∑–æ–Ω ${c.seasonNumber}`}),e.jsxs("span",{className:n.seasonProgress,children:[m," / ",c.episodeCount," —Å–µ—Ä–∏–π"]})]}),e.jsxs("div",{className:n.seasonActions,children:[m<c.episodeCount&&e.jsx("button",{className:n.markAllButton,onClick:u=>{u.stopPropagation(),f(c)},title:"–û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–∏–∏",children:"‚úì –í—Å–µ"}),e.jsx("span",{className:n.expandIcon,children:x?"‚ñº":"‚ñ∂"})]})]}),e.jsx("div",{className:n.progressBar,children:e.jsx("div",{className:n.progressFill,style:{width:`${k}%`}})}),x&&e.jsx("div",{className:n.episodesList,children:Array.from({length:c.episodeCount},(u,b)=>b+1).map(u=>{const b=s(c.seasonNumber,u);return e.jsxs("button",{className:`${n.episodeButton} ${b?n.watched:""}`,onClick:()=>d(c.seasonNumber,u),title:`–°–µ—Ä–∏—è ${u}`,children:[e.jsx("span",{className:n.episodeNumber,children:u}),b&&e.jsx("span",{className:n.checkmark,children:"‚úì"})]},u)})}),!x&&y>0&&e.jsxs("div",{className:n.lastWatched,children:["–ü–æ—Å–ª–µ–¥–Ω—è—è: —Å–µ—Ä–∏—è ",y]})]},`season-${c.id||c.seasonNumber||i}`)})})]})},ge="_ratingSelector_1mwfu_3",Ne="_ratingLabel_1mwfu_25",je="_ratingButtons_1mwfu_41",we="_ratingButton_1mwfu_41",ve="_active_1mwfu_103",fe="_selected_1mwfu_117",be="_loadingIndicator_1mwfu_143",N={ratingSelector:ge,ratingLabel:Ne,ratingButtons:je,ratingButton:we,active:ve,selected:fe,loadingIndicator:be},Ie=({media:o,currentRating:r=null,onRatingSet:p})=>{const l=R(),[j,_]=I.useState(null),[s,w]=I.useState(!1),v=async d=>{if(!s){w(!0);try{await l(E({tmdbId:o.tmdbId,mediaType:o.mediaType,rating:d})).unwrap(),p&&p(d)}catch(f){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞:",f)}finally{w(!1)}}},h=j||r;return e.jsxs("div",{className:N.ratingSelector,children:[e.jsxs("div",{className:N.ratingLabel,children:["–í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞: ",h?`${h}/10`:"–Ω–µ –æ—Ü–µ–Ω–µ–Ω–æ"]}),e.jsx("div",{className:N.ratingButtons,children:[1,2,3,4,5,6,7,8,9,10].map(d=>e.jsx("button",{className:`${N.ratingButton} ${h&&d<=h?N.active:""} ${r===d?N.selected:""}`,onClick:()=>v(d),onMouseEnter:()=>_(d),onMouseLeave:()=>_(null),disabled:s,title:`–û—Ü–µ–Ω–∏—Ç—å –Ω–∞ ${d}`,children:d},d))}),s&&e.jsx("div",{className:N.loadingIndicator,children:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ..."})]})},ye="_mediaDetailPage_12x3u_1",Se="_backdrop_12x3u_13",ke="_content_12x3u_57",Be="_backButton_12x3u_73",Le="_mainInfo_12x3u_109",Te="_posterSection_12x3u_123",Ce="_poster_12x3u_123",$e="_infoSection_12x3u_147",Pe="_title_12x3u_161",qe="_originalTitle_12x3u_177",We="_meta_12x3u_191",Ae="_type_12x3u_209",Re="_separator_12x3u_219",Ee="_rating_12x3u_227",De="_overview_12x3u_237",Fe="_actions_12x3u_251",He="_actionButton_12x3u_265",Ge="_inList_12x3u_311",Me="_inWatchlist_12x3u_321",Ue="_selector_12x3u_365",Ye="_select_12x3u_365",ze="_confirmButton_12x3u_405",Je="_episodeSection_12x3u_515",Ke="_loading_12x3u_523",Oe="_creditsSection_12x3u_699",Qe="_sectionTitle_12x3u_715",Ve="_castSection_12x3u_731",Xe="_castGrid_12x3u_739",Ze="_castCard_12x3u_751",es="_castPhoto_12x3u_765",ss="_castImage_12x3u_789",ts="_noPhoto_12x3u_801",as="_castInfo_12x3u_811",cs="_castName_12x3u_819",is="_castCharacter_12x3u_835",ns="_crewSection_12x3u_851",os="_crewList_12x3u_861",rs="_crewItem_12x3u_873",ls="_crewRole_12x3u_889",ds="_crewName_12x3u_903",a={mediaDetailPage:ye,backdrop:Se,content:ke,backButton:Be,mainInfo:Le,posterSection:Te,poster:Ce,infoSection:$e,title:Pe,originalTitle:qe,meta:We,type:Ae,separator:Re,rating:Ee,overview:De,actions:Fe,actionButton:He,inList:Ge,inWatchlist:Me,selector:Ue,select:Ye,confirmButton:ze,episodeSection:Je,loading:Ke,creditsSection:Oe,sectionTitle:Qe,castSection:Ve,castGrid:Xe,castCard:Ze,castPhoto:es,castImage:ss,noPhoto:ts,castInfo:as,castName:cs,castCharacter:is,crewSection:ns,crewList:os,crewItem:rs,crewRole:ls,crewName:ds},us=()=>{const{mediaType:o,mediaId:r}=D(),p=F(),l=H(),{alertDialog:j,showAlert:_}=O(),{selectedMedia:s,loading:w}=B(t=>t.media),{customLists:v,episodeProgress:h,ratings:d,watchlist:f}=B(t=>t.lists),{user:c}=B(t=>t.auth),[i,m]=I.useState(""),[x,y]=I.useState(!1);I.useEffect(()=>{o&&r&&(l(G({type:o,id:r})),l(M()),o==="tv"&&l(U(r)))},[l,o,r]);const k=async()=>{if(!(!i||!s))try{await l(J({listId:i,media:{tmdbId:s.id,mediaType:s.media_type||o}})).unwrap(),y(!1),m(""),await _({title:"–£—Å–ø–µ—à–Ω–æ!",message:"–ö–æ–Ω—Ç–µ–Ω—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫",type:"success"})}catch{await _({title:"–û—à–∏–±–∫–∞",message:"–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫",type:"error"})}},u=async()=>{if(s)try{if(S){const t=f.find(g=>g.tmdbId===parseInt(r)&&g.mediaType===(s.media_type||o));t&&(await l(Y(t.id)).unwrap(),await _({title:"–£—Å–ø–µ—à–Ω–æ!",message:"–£–¥–∞–ª–µ–Ω–æ –∏–∑ —Å–ø–∏—Å–∫–∞ –∂–µ–ª–∞–µ–º–æ–≥–æ",type:"success"}))}else await l(z({tmdbId:s.id,mediaType:s.media_type||o})).unwrap(),await _({title:"–£—Å–ø–µ—à–Ω–æ!",message:"–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Å–ø–∏—Å–æ–∫ –∂–µ–ª–∞–µ–º–æ–≥–æ",type:"success"})}catch{await _({title:"–û—à–∏–±–∫–∞",message:S?"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ –∂–µ–ª–∞–µ–º–æ–≥–æ":"–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫ –∂–µ–ª–∞–µ–º–æ–≥–æ",type:"error"})}},b=async(t,g)=>{if(s)try{await l(K({tmdbId:s.id,seasonNumber:t,episodeNumber:g})).unwrap()}catch(A){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–º–µ—Ç–∫–µ —Å–µ—Ä–∏–∏:",A)}};if(w||!s)return e.jsx("div",{className:a.loading,children:e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞..."})});const L=s.backdrop_path?`https://image.tmdb.org/t/p/original${s.backdrop_path}`:null,$=s.poster_path?`https://image.tmdb.org/t/p/w500${s.poster_path}`:"/default-poster.png",T=s.release_date||s.first_air_date?new Date(s.release_date||s.first_air_date).getFullYear():null,P=v.filter(t=>t.mediaType===(s.media_type||o)),q=h[r]||[],W=d[r]||null,S=f.some(t=>t.tmdbId===parseInt(r)&&t.mediaType===(s.media_type||o)),C=v.find(t=>t.items&&t.items.some(g=>g.tmdbId===parseInt(r)&&g.mediaType===(s.media_type||o)));return e.jsxs(e.Fragment,{children:[j,e.jsxs("div",{className:a.mediaDetailPage,children:[L&&e.jsx("div",{className:a.backdrop,style:{backgroundImage:`url(${L})`}}),e.jsxs("div",{className:a.content,children:[e.jsx("button",{className:a.backButton,onClick:()=>p(-1),children:"‚Üê –ù–∞–∑–∞–¥"}),e.jsxs("div",{className:a.mainInfo,children:[e.jsx("div",{className:a.posterSection,children:e.jsx("img",{src:$,alt:s.title||s.name,className:a.poster})}),e.jsxs("div",{className:a.infoSection,children:[e.jsx("h1",{className:a.title,children:s.title||s.name}),s.original_title&&s.original_title!==s.title&&e.jsx("p",{className:a.originalTitle,children:s.original_title||s.original_name}),e.jsxs("div",{className:a.meta,children:[e.jsx("span",{className:a.type,children:(s.media_type||o)==="movie"?"–§–∏–ª—å–º":"–°–µ—Ä–∏–∞–ª"}),T&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:a.separator,children:"‚Ä¢"}),e.jsx("span",{children:T})]}),s.vote_average>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:a.separator,children:"‚Ä¢"}),e.jsxs("span",{className:a.rating,children:["‚òÖ ",s.vote_average.toFixed(1)]})]})]}),s.overview&&e.jsx("p",{className:a.overview,children:s.overview}),e.jsxs("div",{className:a.actions,children:[C?e.jsxs("button",{className:`${a.actionButton} ${a.inList}`,disabled:!0,children:["‚úì –í —Å–ø–∏—Å–∫–µ: ",C.name]}):e.jsx("button",{className:a.actionButton,onClick:()=>y(!x),children:"+ –î–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫"}),e.jsx("button",{className:`${a.actionButton} ${S?a.inWatchlist:""}`,onClick:u,children:S?"‚úì –í —Å–ø–∏—Å–∫–µ –∂–µ–ª–∞–µ–º–æ–≥–æ":"+ –í —Å–ø–∏—Å–æ–∫ –∂–µ–ª–∞–µ–º–æ–≥–æ"})]}),x&&e.jsxs("div",{className:a.selector,children:[e.jsxs("select",{value:i,onChange:t=>m(t.target.value),className:a.select,children:[e.jsx("option",{value:"",children:"–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫"}),P.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("button",{className:a.confirmButton,onClick:k,disabled:!i,children:"–î–æ–±–∞–≤–∏—Ç—å"})]}),e.jsx(Ie,{media:{tmdbId:s.id,mediaType:s.media_type||o,title:s.title||s.name},currentRating:W,onRatingSet:async t=>{await _({title:"–û—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!",message:`–û—Ü–µ–Ω–∫–∞ ${t}/10 –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å—Ç–µ–Ω—É`,type:"success"})}})]})]}),s.credits&&e.jsxs("div",{className:a.creditsSection,children:[s.credits.cast&&s.credits.cast.length>0&&e.jsxs("div",{className:a.castSection,children:[e.jsx("h2",{className:a.sectionTitle,children:"–ê–∫—Ç—ë—Ä—ã"}),e.jsx("div",{className:a.castGrid,children:s.credits.cast.slice(0,12).map(t=>e.jsxs("div",{className:a.castCard,children:[e.jsx("div",{className:a.castPhoto,children:t.profile_path?e.jsx("img",{src:`https://image.tmdb.org/t/p/w185${t.profile_path}`,alt:t.name,className:a.castImage}):e.jsx("div",{className:a.noPhoto,children:"üë§"})}),e.jsxs("div",{className:a.castInfo,children:[e.jsx("p",{className:a.castName,children:t.name}),e.jsx("p",{className:a.castCharacter,children:t.character})]})]},t.id))})]}),s.credits.crew&&s.credits.crew.length>0&&e.jsxs("div",{className:a.crewSection,children:[e.jsx("h2",{className:a.sectionTitle,children:"–°—ä—ë–º–æ—á–Ω–∞—è –≥—Ä—É–ø–ø–∞"}),e.jsxs("div",{className:a.crewList,children:[s.credits.crew.filter(t=>t.job==="Director").slice(0,3).map(t=>e.jsxs("div",{className:a.crewItem,children:[e.jsx("span",{className:a.crewRole,children:"–†–µ–∂–∏—Å—Å—ë—Ä:"}),e.jsx("span",{className:a.crewName,children:t.name})]},`director-${t.id}`)),s.credits.crew.filter(t=>t.job==="Screenplay"||t.job==="Writer").slice(0,3).map(t=>e.jsxs("div",{className:a.crewItem,children:[e.jsx("span",{className:a.crewRole,children:"–°—Ü–µ–Ω–∞—Ä–∏—Å—Ç:"}),e.jsx("span",{className:a.crewName,children:t.name})]},`writer-${t.id}`)),s.credits.crew.filter(t=>t.job==="Producer").slice(0,3).map(t=>e.jsxs("div",{className:a.crewItem,children:[e.jsx("span",{className:a.crewRole,children:"–ü—Ä–æ–¥—é—Å–µ—Ä:"}),e.jsx("span",{className:a.crewName,children:t.name})]},`producer-${t.id}`))]})]})]}),(s.media_type||o)==="tv"&&s.seasons&&e.jsx("div",{className:a.episodeSection,children:e.jsx(xe,{seriesId:s.id,seasons:s.seasons,currentProgress:q,onMarkWatched:b})})]})]})]})};export{us as default};
//# sourceMappingURL=MediaDetailPage-BIqe6Nyc.js.map
