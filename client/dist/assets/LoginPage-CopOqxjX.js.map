{"version":3,"file":"LoginPage-CopOqxjX.js","sources":["../../src/pages/LoginPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { useAppDispatch } from '../hooks/useAppDispatch';\r\nimport { useAppSelector } from '../hooks/useAppSelector';\r\nimport { login } from '../store/slices/authSlice';\r\nimport './LoginPage.css';\r\n\r\n/**\r\n * –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Telegram\r\n * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —Ç–æ–∫–µ–Ω—É –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤\r\n */\r\nfunction LoginPage() {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const dispatch = useAppDispatch();\r\n  \r\n  const { isAuthenticated, loading, error } = useAppSelector((state) => state.auth);\r\n  const [authAttempted, setAuthAttempted] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // –ï—Å–ª–∏ —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é\r\n    if (isAuthenticated) {\r\n      navigate('/', { replace: true });\r\n      return;\r\n    }\r\n\r\n    // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤\r\n    const token = searchParams.get('token');\r\n    const userId = searchParams.get('userId');\r\n    const username = searchParams.get('username');\r\n    const displayName = searchParams.get('displayName');\r\n    const avatarUrl = searchParams.get('avatarUrl');\r\n\r\n    // –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–æ–∫–µ–Ω –∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—ã—Ç–∞–µ–º—Å—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è\r\n    if (token && userId && !authAttempted) {\r\n      setAuthAttempted(true);\r\n      \r\n      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω –≤ localStorage\r\n      localStorage.setItem('authToken', token);\r\n      \r\n      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\r\n      dispatch(login({\r\n        token,\r\n        userId,\r\n        username,\r\n        displayName,\r\n        avatarUrl\r\n      }));\r\n    }\r\n  }, [searchParams, isAuthenticated, navigate, dispatch, authAttempted]);\r\n\r\n  // –ï—Å–ª–∏ –∏–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞\r\n  if (loading) {\r\n    return (\r\n      <div className=\"login-page\">\r\n        <div className=\"login-container\">\r\n          <div className=\"login-card\">\r\n            <div className=\"login-logo\">\r\n              <h1>watchRebel</h1>\r\n              <p className=\"login-subtitle\">–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –∫–∏–Ω–æ</p>\r\n            </div>\r\n            <div className=\"login-loading\">\r\n              <div className=\"spinner\"></div>\r\n              <p>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è...</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∞\r\n  if (error) {\r\n    return (\r\n      <div className=\"login-page\">\r\n        <div className=\"login-container\">\r\n          <div className=\"login-card\">\r\n            <div className=\"login-logo\">\r\n              <h1>watchRebel</h1>\r\n              <p className=\"login-subtitle\">–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –∫–∏–Ω–æ</p>\r\n            </div>\r\n            <div className=\"login-error\">\r\n              <div className=\"error-icon\">‚ö†Ô∏è</div>\r\n              <h2>–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</h2>\r\n              <p>{error.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è'}</p>\r\n              <button \r\n                className=\"retry-button\"\r\n                onClick={() => window.location.href = '/'}\r\n              >\r\n                –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram\r\n  return (\r\n    <div className=\"login-page\">\r\n      <div className=\"login-container\">\r\n        <div className=\"login-card\">\r\n          <div className=\"login-logo\">\r\n            <h1>watchRebel</h1>\r\n            <p className=\"login-subtitle\">–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –∫–∏–Ω–æ</p>\r\n          </div>\r\n          \r\n          <div className=\"login-content\">\r\n            <div className=\"login-icon\">üé¨</div>\r\n            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>\r\n            <p className=\"login-description\">\r\n              –í–µ–¥–∏—Ç–µ —É—á–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤ –∏ —Å–µ—Ä–∏–∞–ª–æ–≤, –¥–µ–ª–∏—Ç–µ—Å—å –æ—Ç–∑—ã–≤–∞–º–∏ \r\n              –∏ –Ω–∞—Ö–æ–¥–∏—Ç–µ –¥—Ä—É–∑–µ–π —Å –ø–æ—Ö–æ–∂–∏–º–∏ –≤–∫—É—Å–∞–º–∏\r\n            </p>\r\n            \r\n            <div className=\"login-instructions\">\r\n              <h3>–ö–∞–∫ –Ω–∞—á–∞—Ç—å:</h3>\r\n              <ol>\r\n                <li>–û—Ç–∫—Ä–æ–π—Ç–µ Telegram –±–æ—Ç–∞ watchRebel</li>\r\n                <li>–ù–∞–∂–º–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É /start</li>\r\n                <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏–∑ –±–æ—Ç–∞</li>\r\n              </ol>\r\n            </div>\r\n\r\n            <div className=\"login-telegram\">\r\n              <a \r\n                href={`https://t.me/${import.meta.env.VITE_TELEGRAM_BOT_USERNAME || 'watchrebel_bot'}`}\r\n                className=\"telegram-button\"\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                <span className=\"telegram-icon\">‚úàÔ∏è</span>\r\n                –û—Ç–∫—Ä—ã—Ç—å Telegram –±–æ—Ç–∞\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LoginPage;\r\n"],"names":["LoginPage","searchParams","useSearchParams","navigate","useNavigate","dispatch","useAppDispatch","isAuthenticated","loading","error","useAppSelector","state","authAttempted","setAuthAttempted","useState","useEffect","token","userId","username","displayName","avatarUrl","login","jsx","jsxs"],"mappings":"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"}