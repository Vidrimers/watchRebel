{"version":3,"file":"MessagesPage-BQOl4fZt.js","sources":["../../src/components/Messages/ConversationList.jsx","../../src/components/Messages/MessageThread.jsx","../../src/pages/MessagesPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAppSelector } from '../../hooks/useAppSelector';\r\nimport { useAppDispatch } from '../../hooks/useAppDispatch';\r\nimport { fetchConversations, setCurrentConversation } from '../../store/slices/messagesSlice';\r\nimport api from '../../services/api';\r\nimport styles from './ConversationList.module.css';\r\n\r\n/**\r\n * –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤\r\n * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ –¥–∏–∞–ª–æ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–µ–≤—å—é –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è\r\n */\r\nconst ConversationList = ({ onSelectConversation }) => {\r\n  const dispatch = useAppDispatch();\r\n  const { conversations, loading, currentConversation } = useAppSelector((state) => state.messages);\r\n  const { user } = useAppSelector((state) => state.auth);\r\n  const [showNewMessageModal, setShowNewMessageModal] = useState(false);\r\n  const [friends, setFriends] = useState([]);\r\n  const [loadingFriends, setLoadingFriends] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n\r\n  // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∏–∞–ª–æ–≥–∏ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞\r\n  useEffect(() => {\r\n    dispatch(fetchConversations());\r\n  }, [dispatch]);\r\n\r\n  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞\r\n  useEffect(() => {\r\n    if (showNewMessageModal && user) {\r\n      loadFriends();\r\n    }\r\n  }, [showNewMessageModal, user]);\r\n\r\n  const loadFriends = async () => {\r\n    try {\r\n      setLoadingFriends(true);\r\n      const response = await api.get(`/users/${user.id}/friends`);\r\n      setFriends(response.data);\r\n    } catch (error) {\r\n      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥—Ä—É–∑–µ–π:', error);\r\n    } finally {\r\n      setLoadingFriends(false);\r\n    }\r\n  };\r\n\r\n  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –¥–∏–∞–ª–æ–≥–∞\r\n  const handleSelectConversation = (conversation) => {\r\n    dispatch(setCurrentConversation(conversation.id));\r\n    if (onSelectConversation) {\r\n      onSelectConversation(conversation);\r\n    }\r\n  };\r\n\r\n  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–∞ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è\r\n  const handleSelectFriend = (friend) => {\r\n    // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–∏–∞–ª–æ–≥–∞ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è\r\n    const newConversation = {\r\n      id: null, // null –æ–∑–Ω–∞—á–∞–µ—Ç –Ω–æ–≤—ã–π –¥–∏–∞–ª–æ–≥\r\n      otherUser: {\r\n        id: friend.id,\r\n        displayName: friend.displayName,\r\n        avatarUrl: friend.avatarUrl\r\n      },\r\n      lastMessage: null,\r\n      unreadCount: 0,\r\n      lastMessageAt: new Date().toISOString(),\r\n      createdAt: new Date().toISOString()\r\n    };\r\n    \r\n    setShowNewMessageModal(false);\r\n    setSearchQuery('');\r\n    handleSelectConversation(newConversation);\r\n  };\r\n\r\n  // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥—Ä—É–∑–µ–π –ø–æ –ø–æ–∏—Å–∫–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É\r\n  const filteredFriends = friends.filter(friend =>\r\n    friend.displayName.toLowerCase().includes(searchQuery.toLowerCase())\r\n  );\r\n\r\n  // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã\r\n  const formatDate = (dateString) => {\r\n    const date = new Date(dateString);\r\n    const now = new Date();\r\n    const diffMs = now - date;\r\n    const diffMins = Math.floor(diffMs / 60000);\r\n    const diffHours = Math.floor(diffMs / 3600000);\r\n    const diffDays = Math.floor(diffMs / 86400000);\r\n\r\n    if (diffMins < 1) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';\r\n    if (diffMins < 60) return `${diffMins} –º–∏–Ω`;\r\n    if (diffHours < 24) return `${diffHours} —á`;\r\n    if (diffDays < 7) return `${diffDays} –¥–Ω`;\r\n    \r\n    return date.toLocaleDateString('ru-RU', { \r\n      day: 'numeric', \r\n      month: 'short'\r\n    });\r\n  };\r\n\r\n  // –û–±—Ä–µ–∑–∫–∞ –¥–ª–∏–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞\r\n  const truncateText = (text, maxLength = 50) => {\r\n    if (!text) return '';\r\n    if (text.length <= maxLength) return text;\r\n    return text.substring(0, maxLength) + '...';\r\n  };\r\n\r\n  if (loading && conversations.length === 0) {\r\n    return (\r\n      <div className={styles.container}>\r\n        <div className={styles.loading}>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (conversations.length === 0) {\r\n    return (\r\n      <div className={styles.container}>\r\n        <div className={styles.header}>\r\n          <h2 className={styles.title}>–°–æ–æ–±—â–µ–Ω–∏—è</h2>\r\n          <button \r\n            className={styles.newMessageButton}\r\n            onClick={() => setShowNewMessageModal(true)}\r\n            title=\"–ù–∞–ø–∏—Å–∞—Ç—å –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ\"\r\n          >\r\n            ‚úèÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å\r\n          </button>\r\n        </div>\r\n        <div className={styles.empty}>\r\n          <span className={styles.emptyIcon}>üí¨</span>\r\n          <p>–ü–æ–∫–∞ –Ω–µ—Ç –¥–∏–∞–ª–æ–≥–æ–≤</p>\r\n          <p className={styles.emptyHint}>–ù–∞–∂–º–∏—Ç–µ \"–ù–∞–ø–∏—Å–∞—Ç—å\", —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∫—É</p>\r\n        </div>\r\n\r\n        {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–∞ */}\r\n        {showNewMessageModal && (\r\n          <div className={styles.modal} onClick={() => setShowNewMessageModal(false)}>\r\n            <div className={styles.modalContent} onClick={(e) => e.stopPropagation()}>\r\n              <div className={styles.modalHeader}>\r\n                <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</h3>\r\n                <button \r\n                  className={styles.closeButton}\r\n                  onClick={() => setShowNewMessageModal(false)}\r\n                >\r\n                  √ó\r\n                </button>\r\n              </div>\r\n              \r\n              <input\r\n                type=\"text\"\r\n                className={styles.searchInput}\r\n                placeholder=\"–ü–æ–∏—Å–∫ –¥—Ä—É–∑–µ–π...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                autoFocus\r\n              />\r\n\r\n              <div className={styles.friendsList}>\r\n                {loadingFriends ? (\r\n                  <div className={styles.modalLoading}>–ó–∞–≥—Ä—É–∑–∫–∞ –¥—Ä—É–∑–µ–π...</div>\r\n                ) : filteredFriends.length === 0 ? (\r\n                  <div className={styles.modalEmpty}>\r\n                    {searchQuery ? '–î—Ä—É–∑—å—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã' : '–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π'}\r\n                  </div>\r\n                ) : (\r\n                  filteredFriends.map((friend) => (\r\n                    <div\r\n                      key={friend.id}\r\n                      className={styles.friendItem}\r\n                      onClick={() => handleSelectFriend(friend)}\r\n                    >\r\n                      <div className={styles.friendAvatar}>\r\n                        {friend.avatarUrl ? (\r\n                          <img \r\n                            src={friend.avatarUrl} \r\n                            alt={friend.displayName}\r\n                            className={styles.friendAvatarImage}\r\n                          />\r\n                        ) : (\r\n                          <div className={styles.friendAvatarPlaceholder}>\r\n                            {friend.displayName.charAt(0).toUpperCase()}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <span className={styles.friendName}>{friend.displayName}</span>\r\n                    </div>\r\n                  ))\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      <div className={styles.header}>\r\n        <h2 className={styles.title}>–°–æ–æ–±—â–µ–Ω–∏—è</h2>\r\n        <button \r\n          className={styles.newMessageButton}\r\n          onClick={() => setShowNewMessageModal(true)}\r\n          title=\"–ù–∞–ø–∏—Å–∞—Ç—å –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ\"\r\n        >\r\n          ‚úèÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å\r\n        </button>\r\n      </div>\r\n      \r\n      <ul className={styles.list}>\r\n        {conversations.map((conversation) => (\r\n          <li\r\n            key={conversation.id}\r\n            className={`${styles.item} ${currentConversation === conversation.id ? styles.active : ''}`}\r\n            onClick={() => handleSelectConversation(conversation)}\r\n          >\r\n            <div className={styles.avatar}>\r\n              {conversation.otherUser.avatarUrl ? (\r\n                <img \r\n                  src={conversation.otherUser.avatarUrl} \r\n                  alt={conversation.otherUser.displayName}\r\n                  className={styles.avatarImage}\r\n                />\r\n              ) : (\r\n                <div className={styles.avatarPlaceholder}>\r\n                  {conversation.otherUser.displayName.charAt(0).toUpperCase()}\r\n                </div>\r\n              )}\r\n            </div>\r\n            \r\n            <div className={styles.content}>\r\n              <div className={styles.topRow}>\r\n                <span className={styles.name}>{conversation.otherUser.displayName}</span>\r\n                <span className={styles.time}>{formatDate(conversation.lastMessageAt)}</span>\r\n              </div>\r\n              <div className={styles.bottomRow}>\r\n                <p className={styles.lastMessage}>\r\n                  {truncateText(conversation.lastMessage)}\r\n                </p>\r\n                {conversation.unreadCount > 0 && (\r\n                  <div className={styles.unreadBadge}>\r\n                    {conversation.unreadCount}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n\r\n      {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–∞ */}\r\n      {showNewMessageModal && (\r\n        <div className={styles.modal} onClick={() => setShowNewMessageModal(false)}>\r\n          <div className={styles.modalContent} onClick={(e) => e.stopPropagation()}>\r\n            <div className={styles.modalHeader}>\r\n              <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</h3>\r\n              <button \r\n                className={styles.closeButton}\r\n                onClick={() => setShowNewMessageModal(false)}\r\n              >\r\n                √ó\r\n              </button>\r\n            </div>\r\n            \r\n            <input\r\n              type=\"text\"\r\n              className={styles.searchInput}\r\n              placeholder=\"–ü–æ–∏—Å–∫ –¥—Ä—É–∑–µ–π...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              autoFocus\r\n            />\r\n\r\n            <div className={styles.friendsList}>\r\n              {loadingFriends ? (\r\n                <div className={styles.modalLoading}>–ó–∞–≥—Ä—É–∑–∫–∞ –¥—Ä—É–∑–µ–π...</div>\r\n              ) : filteredFriends.length === 0 ? (\r\n                <div className={styles.modalEmpty}>\r\n                  {searchQuery ? '–î—Ä—É–∑—å—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã' : '–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π'}\r\n                </div>\r\n              ) : (\r\n                filteredFriends.map((friend) => (\r\n                  <div\r\n                    key={friend.id}\r\n                    className={styles.friendItem}\r\n                    onClick={() => handleSelectFriend(friend)}\r\n                  >\r\n                    <div className={styles.friendAvatar}>\r\n                      {friend.avatarUrl ? (\r\n                        <img \r\n                          src={friend.avatarUrl} \r\n                          alt={friend.displayName}\r\n                          className={styles.friendAvatarImage}\r\n                        />\r\n                      ) : (\r\n                        <div className={styles.friendAvatarPlaceholder}>\r\n                          {friend.displayName.charAt(0).toUpperCase()}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <span className={styles.friendName}>{friend.displayName}</span>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ConversationList;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useAppSelector } from '../../hooks/useAppSelector';\r\nimport { useAppDispatch } from '../../hooks/useAppDispatch';\r\nimport { fetchMessages, sendMessage, deleteMessage } from '../../store/slices/messagesSlice';\r\nimport styles from './MessageThread.module.css';\r\n\r\n/**\r\n * –û–∫–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∫–∏\r\n * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –¥–∏–∞–ª–æ–≥–µ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ\r\n */\r\nconst MessageThread = ({ conversation }) => {\r\n  const dispatch = useAppDispatch();\r\n  const { messages, loading, sendingMessage } = useAppSelector((state) => state.messages);\r\n  const { user } = useAppSelector((state) => state.auth);\r\n  const [messageText, setMessageText] = useState('');\r\n  const messagesEndRef = useRef(null);\r\n\r\n  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –¥–∏–∞–ª–æ–≥–∞\r\n  useEffect(() => {\r\n    if (conversation && conversation.id) {\r\n      dispatch(fetchMessages(conversation.id));\r\n    }\r\n  }, [conversation, dispatch]);\r\n\r\n  // –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è\r\n  const handleSendMessage = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!messageText.trim() || sendingMessage) return;\r\n\r\n    const content = messageText.trim();\r\n    setMessageText('');\r\n\r\n    const result = await dispatch(sendMessage({\r\n      receiverId: conversation.otherUser.id,\r\n      content\r\n    }));\r\n\r\n    // –ï—Å–ª–∏ —ç—Ç–æ –Ω–æ–≤—ã–π –¥–∏–∞–ª–æ–≥ (id === null), –æ–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤\r\n    if (conversation.id === null && result.meta.requestStatus === 'fulfilled') {\r\n      // –î–∏–∞–ª–æ–≥ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ fetchConversations\r\n      // –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ ConversationList –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\r\n    }\r\n  };\r\n\r\n  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è Enter\r\n  const handleKeyDown = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendMessage(e);\r\n    }\r\n  };\r\n\r\n  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É–¥–∞–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è\r\n  const handleDeleteMessage = (messageId) => {\r\n    if (window.confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ?')) {\r\n      dispatch(deleteMessage(messageId));\r\n    }\r\n  };\r\n\r\n  // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏\r\n  const formatTime = (dateString) => {\r\n    const date = new Date(dateString);\r\n    return date.toLocaleTimeString('ru-RU', { \r\n      hour: '2-digit', \r\n      minute: '2-digit' \r\n    });\r\n  };\r\n\r\n  // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã –¥–ª—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è\r\n  const formatDateSeparator = (dateString) => {\r\n    const date = new Date(dateString);\r\n    const today = new Date();\r\n    const yesterday = new Date(today);\r\n    yesterday.setDate(yesterday.getDate() - 1);\r\n\r\n    if (date.toDateString() === today.toDateString()) {\r\n      return '–°–µ–≥–æ–¥–Ω—è';\r\n    } else if (date.toDateString() === yesterday.toDateString()) {\r\n      return '–í—á–µ—Ä–∞';\r\n    } else {\r\n      return date.toLocaleDateString('ru-RU', { \r\n        day: 'numeric', \r\n        month: 'long',\r\n        year: date.getFullYear() !== today.getFullYear() ? 'numeric' : undefined\r\n      });\r\n    }\r\n  };\r\n\r\n  // –ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω—É–∂–µ–Ω –ª–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –¥–∞—Ç—ã\r\n  const shouldShowDateSeparator = (currentMessage, previousMessage) => {\r\n    if (!previousMessage) return true;\r\n    \r\n    const currentDate = new Date(currentMessage.createdAt).toDateString();\r\n    const previousDate = new Date(previousMessage.createdAt).toDateString();\r\n    \r\n    return currentDate !== previousDate;\r\n  };\r\n\r\n  if (!conversation) {\r\n    return (\r\n      <div className={styles.container}>\r\n        <div className={styles.empty}>\r\n          <span className={styles.emptyIcon}>üí¨</span>\r\n          <p>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ª–æ–≥ –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–ø–∏—Å–∫–∏</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (loading && messages.length === 0) {\r\n    return (\r\n      <div className={styles.container}>\r\n        <div className={styles.header}>\r\n          <div className={styles.headerAvatar}>\r\n            {conversation.otherUser.avatarUrl ? (\r\n              <img \r\n                src={conversation.otherUser.avatarUrl} \r\n                alt={conversation.otherUser.displayName}\r\n                className={styles.headerAvatarImage}\r\n              />\r\n            ) : (\r\n              <div className={styles.headerAvatarPlaceholder}>\r\n                {conversation.otherUser.displayName.charAt(0).toUpperCase()}\r\n              </div>\r\n            )}\r\n          </div>\r\n          <h2 className={styles.headerName}>{conversation.otherUser.displayName}</h2>\r\n        </div>\r\n        <div className={styles.loading}>–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      {/* –®–∞–ø–∫–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–µ */}\r\n      <div className={styles.header}>\r\n        <div className={styles.headerAvatar}>\r\n          {conversation.otherUser.avatarUrl ? (\r\n            <img \r\n              src={conversation.otherUser.avatarUrl} \r\n              alt={conversation.otherUser.displayName}\r\n              className={styles.headerAvatarImage}\r\n            />\r\n          ) : (\r\n            <div className={styles.headerAvatarPlaceholder}>\r\n              {conversation.otherUser.displayName.charAt(0).toUpperCase()}\r\n            </div>\r\n          )}\r\n        </div>\r\n        <h2 className={styles.headerName}>{conversation.otherUser.displayName}</h2>\r\n      </div>\r\n\r\n      {/* –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π */}\r\n      <div className={styles.messagesContainer}>\r\n        {messages.length === 0 ? (\r\n          <div className={styles.emptyMessages}>\r\n            <p>–ù–∞—á–Ω–∏—Ç–µ –ø–µ—Ä–µ–ø–∏—Å–∫—É —Å {conversation.otherUser.displayName}</p>\r\n          </div>\r\n        ) : (\r\n          <div className={styles.messagesList}>\r\n            {messages.map((message, index) => {\r\n              const isOwnMessage = message.senderId === user.id;\r\n              const showDateSeparator = shouldShowDateSeparator(message, messages[index - 1]);\r\n\r\n              return (\r\n                <React.Fragment key={message.id}>\r\n                  {showDateSeparator && (\r\n                    <div className={styles.dateSeparator}>\r\n                      {formatDateSeparator(message.createdAt)}\r\n                    </div>\r\n                  )}\r\n                  \r\n                  <div className={`${styles.message} ${isOwnMessage ? styles.ownMessage : styles.otherMessage}`}>\r\n                    {!isOwnMessage && (\r\n                      <div className={styles.messageAvatar}>\r\n                        {conversation.otherUser.avatarUrl ? (\r\n                          <img \r\n                            src={conversation.otherUser.avatarUrl} \r\n                            alt={conversation.otherUser.displayName}\r\n                            className={styles.messageAvatarImage}\r\n                          />\r\n                        ) : (\r\n                          <div className={styles.messageAvatarPlaceholder}>\r\n                            {conversation.otherUser.displayName.charAt(0).toUpperCase()}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                    \r\n                    <div className={styles.messageBubble}>\r\n                      <p className={styles.messageText}>{message.content}</p>\r\n                      <div className={styles.messageFooter}>\r\n                        <span className={styles.messageTime}>{formatTime(message.createdAt)}</span>\r\n                        {isOwnMessage && (\r\n                          <button\r\n                            className={styles.deleteButton}\r\n                            onClick={() => handleDeleteMessage(message.id)}\r\n                            title=\"–£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ\"\r\n                          >\r\n                            √ó\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </React.Fragment>\r\n              );\r\n            })}\r\n            <div ref={messagesEndRef} />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* –§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è */}\r\n      <form className={styles.inputForm} onSubmit={handleSendMessage}>\r\n        <textarea\r\n          className={styles.input}\r\n          value={messageText}\r\n          onChange={(e) => setMessageText(e.target.value)}\r\n          onKeyDown={handleKeyDown}\r\n          placeholder=\"–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...\"\r\n          rows={1}\r\n          disabled={sendingMessage}\r\n        />\r\n        <button\r\n          type=\"submit\"\r\n          className={styles.sendButton}\r\n          disabled={!messageText.trim() || sendingMessage}\r\n        >\r\n          {sendingMessage ? '...' : '‚û§'}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MessageThread;\r\n","import React, { useState } from 'react';\r\nimport UserPageLayout from '../components/Layout/UserPageLayout';\r\nimport ConversationList from '../components/Messages/ConversationList';\r\nimport MessageThread from '../components/Messages/MessageThread';\r\nimport styles from './MessagesPage.module.css';\r\n\r\n/**\r\n * –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ–æ–±—â–µ–Ω–∏–π\r\n * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ –∏ –æ–∫–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∫–∏\r\n */\r\nconst MessagesPage = () => {\r\n  const [selectedConversation, setSelectedConversation] = useState(null);\r\n\r\n  const handleSelectConversation = (conversation) => {\r\n    setSelectedConversation(conversation);\r\n  };\r\n\r\n  return (\r\n    <UserPageLayout>\r\n      <div className={styles.container}>\r\n        <div className={styles.conversationListPanel}>\r\n          <ConversationList onSelectConversation={handleSelectConversation} />\r\n        </div>\r\n        <div className={styles.messageThreadPanel}>\r\n          <MessageThread conversation={selectedConversation} />\r\n        </div>\r\n      </div>\r\n    </UserPageLayout>\r\n  );\r\n};\r\n\r\nexport default MessagesPage;\r\n"],"names":["ConversationList","onSelectConversation","dispatch","useAppDispatch","conversations","loading","currentConversation","useAppSelector","state","user","showNewMessageModal","setShowNewMessageModal","useState","friends","setFriends","loadingFriends","setLoadingFriends","searchQuery","setSearchQuery","useEffect","fetchConversations","loadFriends","response","api","error","handleSelectConversation","conversation","setCurrentConversation","handleSelectFriend","friend","newConversation","filteredFriends","formatDate","dateString","date","diffMs","diffMins","diffHours","diffDays","truncateText","text","maxLength","jsx","styles","jsxs","e","MessageThread","messages","sendingMessage","messageText","setMessageText","messagesEndRef","useRef","fetchMessages","scrollToBottom","_a","handleSendMessage","content","result","sendMessage","handleKeyDown","handleDeleteMessage","messageId","deleteMessage","formatTime","formatDateSeparator","today","yesterday","shouldShowDateSeparator","currentMessage","previousMessage","currentDate","previousDate","message","index","isOwnMessage","showDateSeparator","React","MessagesPage","selectedConversation","setSelectedConversation","UserPageLayout"],"mappings":"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"}